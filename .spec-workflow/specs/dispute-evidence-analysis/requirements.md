# Requirements Document

## Introduction

本功能重构第二幕的争议焦点分析和证据质证模块，以**用户体验**为核心设计原则。通过故事化展示、互动式操作、渐进式披露等设计，让复杂的法律分析变得直观易懂。将请求权基础自然融入争议焦点和证据质证中，避免概念堆砌，真正实现"在体验中学习法律"。

## Alignment with Product Vision

本功能以体验优先原则契合平台愿景：
- **老师体验**：备课效率提升50%，获得灵活的教学控制权
- **学生体验**：从被动听讲到主动探索，像律师一样思考
- **教学效果**：通过更好的体验带来更深的理解和记忆

## Requirements

### Requirement 1: 故事化争议焦点分析

**User Story:** 作为法学学生，我希望通过"原告说-被告说-法官认为"的故事化方式理解争议焦点，并自然地学习相关的请求权基础。

#### Acceptance Criteria

1. WHEN 用户进入争议焦点模块 THEN 系统 SHALL 以卡片形式展示所有争议焦点
2. IF 用户点击争议卡片 THEN 系统 SHALL 以对话形式展示三方观点（原告主张→被告抗辩→法院认定）
3. WHEN 展示争议内容时 THEN 系统 SHALL 在每个争议卡片上自动标注相关的请求权基础标签
4. WHEN 老师使用时 THEN 系统 SHALL 提供难度切换（基础/进阶/专业），控制内容深度
5. IF 学生选择基础模式 THEN 系统 SHALL 使用通俗语言解释，专业术语提供悬浮解释

#### 体验要求
- 视觉设计采用对话气泡样式，模拟真实辩论
- 支持视角切换（原告/被告/法官），帮助学生换位思考
- 请求权标签使用不同颜色区分类型（合同/侵权/物权等）

### Requirement 2: 互动式证据质证系统

**User Story:** 作为法学学生，我希望通过拖拽、选择等互动方式参与证据质证，在实践中理解证据与请求权要件的关系。

#### Acceptance Criteria

1. WHEN 用户进入证据质证模块 THEN 系统 SHALL 提供两种模式选择（观看模式/练习模式）
2. IF 选择观看模式 THEN 系统 SHALL 自动播放AI的证据分析过程，支持暂停和步进
3. IF 选择练习模式 THEN 系统 SHALL 显示证据卡片和请求权要件框，支持拖拽匹配
4. WHEN 学生拖拽证据到要件框 THEN 系统 SHALL 即时反馈匹配是否正确，并解释原因
5. WHEN 点击证据卡片 THEN 系统 SHALL 弹出质证对话框，引导学生思考三性（真实性/关联性/合法性）

#### 体验要求
- 证据设计为可翻转的卡片（正面基本信息，背面质证要点）
- 拖拽操作要有视觉反馈（高亮、动画）
- 正确匹配时给予积极反馈（音效、动画、积分）
- 提供进度条显示完成度，激励学生完成全部质证

### Requirement 3: 智能教学辅助

**User Story:** 作为法学老师，我希望系统提供智能的教学辅助功能，帮助我更好地组织课堂讨论。

#### Acceptance Criteria

1. WHEN 老师准备课程时 THEN 系统 SHALL 自动标注每个争议的教学价值（高/中/低）
2. IF 老师选择某个争议 THEN 系统 SHALL 提供建议的讨论问题和教学要点
3. WHEN 课堂展示时 THEN 系统 SHALL 支持内容的渐进式展开（先问题→再观点→最后结论）
4. WHEN 需要课堂互动时 THEN 系统 SHALL 提供快速投票功能（学生选择支持哪方观点）
5. IF 课后复习 THEN 系统 SHALL 生成本案例的知识点总结和练习题

## Non-Functional Requirements

### Code Architecture and Modularity
- **组件化设计**: 争议卡片、证据卡片、质证对话框等均为独立可复用组件
- **状态管理**: 扩展现有Zustand store，添加用户交互状态（拖拽状态、选择状态、进度状态）
- **模式分离**: 观看模式和练习模式的逻辑分离，便于独立优化

### Performance
- 拖拽操作响应时间 < 100ms，保证流畅体验
- AI分析采用流式输出，3秒内开始显示结果
- 支持30个证据的流畅拖拽和展示
- 动画效果在低端设备可自动降级

### Security
- 练习模式的答案不在前端暴露，通过API验证
- 学生练习记录仅保存在本地
- API调用限制：每用户每分钟最多20次

### Reliability
- 拖拽操作支持撤销和重做
- 网络异常时保存用户的操作状态
- 提供离线模式基础功能（查看已缓存内容）

### Usability
- **移动适配**: 手机端将拖拽改为点选模式
- **无障碍**: 支持键盘操作完成所有交互
- **视觉反馈**: 所有操作都有明确的视觉/听觉反馈
- **新手引导**: 首次使用时提供交互式教程
- **个性化**: 记住用户的模式偏好和难度选择