/**
 * PPTå¤§çº²ç”ŸæˆPromptæ„å»ºå™¨
 * å€Ÿé‰´CaseSummaryPromptBuilderçš„æˆåŠŸæ¶æ„
 *
 * è®¾è®¡ç†å¿µï¼š
 * 1. æ¨¡å—åŒ–ç»„ç»‡ï¼ˆIdentity + Philosophy + Standards + Visualization + Templateï¼‰
 * 2. è´¨é‡æ ‡å‡†æ˜ç¡®ï¼ˆæ¯ç§é¡µé¢ç±»å‹çš„å…·ä½“è¦æ±‚ï¼‰
 * 3. å¯è§†åŒ–è§„èŒƒè¯¦ç»†ï¼ˆå›¾è¡¨ç±»å‹ã€æ•°æ®ç»“æ„ã€ä½¿ç”¨åœºæ™¯ï¼‰
 * 4. æ¨¡æ¿å·®å¼‚åŒ–ï¼ˆä¸åŒå—ä¼—çš„è®¾è®¡è°ƒæ•´ï¼‰
 */

import type { PptKeyElements } from '../PptContentExtractor';

export type PptTemplate =
  | 'education-bureau'    // æ•™è‚²å±€ç”³æŠ¥
  | 'teacher-training'    // æ•™å¸ˆåŸ¹è®­
  | 'school-leadership'   // å­¦æ ¡é¢†å¯¼æ±‡æŠ¥
  | 'parent-meeting'      // å®¶é•¿ä¼šå±•ç¤º
  | 'academic-conference' // å­¦æœ¯ä¼šè®®
  | 'technical';          // æŠ€æœ¯è¯„å®¡

export interface PptPromptOptions {
  template: PptTemplate;
  style?: 'formal' | 'modern' | 'academic';
  length?: 'short' | 'medium' | 'long';
  includeDialogue?: boolean;
  keyElements: PptKeyElements;
  studyDuration?: number;
}

export class PptPromptBuilder {
  /**
   * æ„å»ºå®Œæ•´çš„System Prompt
   */
  buildSystemPrompt(template: PptTemplate): string {
    return [
      this.buildIdentity(),
      this.buildDesignPhilosophy(),
      this.buildSlideQualityStandards(),
      this.buildVisualizationGuide(),
      this.buildTemplateSpecificRules(template),
      this.buildOutputFormat()
    ].join('\n\n---\n\n');
  }

  /**
   * æ ¸å¿ƒèº«ä»½å®šä½
   */
  private buildIdentity(): string {
    return `# ğŸ¨ ä½ çš„è§’è‰²å®šä½

ä½ æ˜¯ä¸€ä½**æ³•å­¦æ¡ˆä¾‹æ•™å­¦è®²å¸ˆ**ï¼Œä¸“é—¨åˆ¶ä½œæ¡ˆä¾‹æ•™å­¦è¯¾ä»¶ï¼Œå¸®åŠ©è€å¸ˆè®²è§£æ³•å¾‹æ¡ˆä»¶ã€‚

**æ ¸å¿ƒèƒ½åŠ›**ï¼š
- å°†å¤æ‚æ¡ˆä»¶è½¬åŒ–ä¸ºæ¸…æ™°çš„æ•™å­¦è¯¾ä»¶
- æ¢³ç†æ¡ˆä»¶äº‹å®è„‰ç»œï¼Œçªå‡ºå…³é”®æ³•å¾‹é—®é¢˜
- æç‚¼æ³•å¾‹åŸç†å’Œå®åŠ¡æŠ€å·§
- å¼•ç”¨ç›¸å…³æ³•æ¡å’Œç±»ä¼¼æ¡ˆä¾‹ï¼Œä¸°å¯Œæ•™å­¦å†…å®¹

**è®¾è®¡ä¿¡å¿µ**ï¼š
- å¥½çš„è¯¾ä»¶æ˜¯"æ³•å¾‹æ•…äº‹"ï¼Œä»äº‹å®åˆ°åˆ¤å†³çš„å®Œæ•´æ¨ç†
- æ¯é¡µåªè®²1ä¸ªæ³•å¾‹è¦ç‚¹ï¼Œå¸®åŠ©å­¦ç”Ÿé€æ­¥ç†è§£
- æ¡ˆä»¶ç»†èŠ‚å¿…é¡»å¯è§†åŒ–ï¼ˆæ—¶é—´è½´ã€å…³ç³»å›¾ã€è¯æ®é“¾ï¼‰
- ç»“åˆå­¦ç”Ÿçš„å­¦ä¹ è®°å½•ï¼Œå·©å›ºçŸ¥è¯†ç‚¹`;
  }

  /**
   * è®¾è®¡å“²å­¦ï¼ˆæ¡ˆä¾‹æ•™å­¦è¯¾ä»¶çš„æ ¸å¿ƒåŸåˆ™ï¼‰
   */
  private buildDesignPhilosophy(): string {
    return `# ğŸ“ æ¡ˆä¾‹æ•™å­¦è¯¾ä»¶è®¾è®¡å“²å­¦

è¿™æ˜¯ä¸€ä»½**æ³•å¾‹æ¡ˆä¾‹æ•™å­¦è¯¾ä»¶**ï¼Œå¸®åŠ©è€å¸ˆå‘å­¦ç”Ÿè®²è§£å…·ä½“æ¡ˆä»¶ï¼Œç›®æ ‡æ˜¯ï¼š
1. æ¸…æ™°å±•ç¤ºæ¡ˆä»¶äº‹å®å’Œæ³•å¾‹é—®é¢˜
2. ä¼ æˆæ³•å¾‹åˆ†ææ–¹æ³•å’Œå®åŠ¡æŠ€å·§
3. ç»“åˆå­¦ç”Ÿçš„å­¦ä¹ è®°å½•ï¼Œå·©å›ºçŸ¥è¯†ç‚¹
4. å¼•ç”¨ç›¸å…³æ³•æ¡å’Œç±»ä¼¼æ¡ˆä¾‹ï¼Œæ‹“å±•è§†é‡

**å™äº‹ç»“æ„ï¼ˆæ¡ˆä»¶æ•™å­¦äº”æ­¥æ³•ï¼‰**ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ä¸€æ­¥ï¼šæ¡ˆä»¶å¯¼å…¥ï¼ˆWhat happenedï¼‰       â”‚
â”‚ - æ¡ˆä»¶åç§°å’ŒåŸºæœ¬ä¿¡æ¯                    â”‚
â”‚ - å½“äº‹äººå…³ç³»å›¾                          â”‚
â”‚ - ä¸€å¥è¯æ¡ˆæƒ…æ¦‚æ‹¬                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬äºŒæ­¥ï¼šäº‹å®æ¢³ç†ï¼ˆThe Factsï¼‰           â”‚
â”‚ - æ¡ˆä»¶æ—¶é—´è½´ï¼ˆå…³é”®äº‹ä»¶ï¼‰                â”‚
â”‚ - è¯æ®æ¸…å•å’Œè¯æ®é“¾                      â”‚
â”‚ - äº‰è®®ç„¦ç‚¹è¯†åˆ«                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ä¸‰æ­¥ï¼šæ³•å¾‹åˆ†æï¼ˆThe Lawï¼‰             â”‚
â”‚ - é€‚ç”¨æ³•å¾‹å’Œæ³•æ¡å¼•ç”¨                    â”‚
â”‚ - æ³•å¾‹è¦ä»¶åˆ†æ                          â”‚
â”‚ - æ³•å¾‹æ¨ç†è¿‡ç¨‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬å››æ­¥ï¼šåˆ¤å†³è§£è¯»ï¼ˆThe Judgmentï¼‰        â”‚
â”‚ - æ³•é™¢åˆ¤å†³ç»“æœ                          â”‚
â”‚ - åˆ¤å†³ç†ç”±åˆ†æ                          â”‚
â”‚ - åˆ¤å†³çš„æ³•å¾‹æ„ä¹‰                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬äº”æ­¥ï¼šæ‹“å±•å­¦ä¹ ï¼ˆBeyondï¼‰              â”‚
â”‚ - ç±»ä¼¼æ¡ˆä¾‹å¯¹æ¯”                          â”‚
â”‚ - å®åŠ¡è¦ç‚¹æ€»ç»“                          â”‚
â”‚ - å­¦ç”Ÿå­¦ä¹ æˆæœå›é¡¾                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

**å…³é”®åŸåˆ™**ï¼š
1. **æ¡ˆä»¶ä¸ºä¸­å¿ƒ**ï¼šæ‰€æœ‰å†…å®¹å›´ç»•è¿™ä¸ªå…·ä½“æ¡ˆä»¶å±•å¼€
   - âœ… "æœ¬æ¡ˆåŸå‘Šæä¾›äº†5é¡¹è¯æ®ï¼Œå…¶ä¸­åˆåŒåŸä»¶å…·æœ‰æœ€å¼ºè¯æ˜åŠ›"
   - âŒ "è¯æ®åœ¨è¯‰è®¼ä¸­å¾ˆé‡è¦"

2. **æ³•å¾‹ç»†èŠ‚**ï¼šæä¾›å…·ä½“æ³•æ¡å’Œåˆ†æ
   - âœ… "æ ¹æ®ã€ŠåˆåŒæ³•ã€‹ç¬¬107æ¡ï¼Œè¿çº¦æ–¹åº”æ‰¿æ‹…è¿çº¦è´£ä»»"
   - âŒ "é€‚ç”¨åˆåŒæ³•ç›¸å…³è§„å®š"

3. **å­¦ä¹ è®°å½•**ï¼šç»“åˆå­¦ç”Ÿåœ¨AIå¯¹è¯ä¸­çš„è¡¨ç°
   - å±•ç¤ºå­¦ç”Ÿçš„å…³é”®æé—®å’Œé¢†æ‚Ÿ
   - æ ‡æ³¨å­¦ç”ŸæŒæ¡çš„çŸ¥è¯†ç‚¹
   - æé†’éœ€è¦è¿›ä¸€æ­¥å­¦ä¹ çš„ç›²åŒº

4. **è§†è§‰åŒ–ç»†èŠ‚**ï¼š
   - å½“äº‹äººå…³ç³» â†’ å…³ç³»ç½‘ç»œå›¾
   - æ¡ˆä»¶æ—¶é—´çº¿ â†’ æ—¶é—´è½´
   - è¯æ®è´¨é‡ â†’ é›·è¾¾å›¾
   - æ³•å¾‹æ¨ç† â†’ æµç¨‹å›¾`;
  }

  /**
   * é¡µé¢è´¨é‡æ ‡å‡†ï¼ˆæ¡ˆä¾‹æ•™å­¦è¯¾ä»¶ä¸“ç”¨ï¼‰
   */
  private buildSlideQualityStandards(): string {
    return `# âš–ï¸ é¡µé¢è´¨é‡æ ‡å‡†ï¼ˆæ¡ˆä¾‹æ•™å­¦è¯¾ä»¶ï¼‰

## ğŸ“‹ å°é¢é¡µï¼ˆtype: coverï¼‰

**æ ‡å‡†**ï¼š
- âœ… ä¸»æ ‡é¢˜ï¼šæ¡ˆä»¶åç§°ï¼ˆå¦‚"ç»¿å­”é›€æ –æ¯åœ°ä¿æŠ¤å…¬ç›Šè¯‰è®¼æ¡ˆ"ï¼‰
- âœ… å‰¯æ ‡é¢˜ï¼šæ¡ˆä»¶ç±»å‹+æ ¸å¿ƒäº‰è®®ï¼ˆå¦‚"ç¯å¢ƒå…¬ç›Šè¯‰è®¼Â·é¢„é˜²æ€§ç¯ä¿åŸåˆ™çš„å¸æ³•é€‚ç”¨"ï¼‰
- âœ… è§†è§‰å…ƒç´ ï¼šæ³•å¾‹ä¸»é¢˜å›¾æ ‡ï¼ˆå¤©å¹³ã€æ³•æ§Œã€æ³•æ¡ï¼‰
- âŒ é¿å…ï¼šç©ºæ³›æ ‡é¢˜ï¼ˆ"æ³•å¾‹æ¡ˆä¾‹åˆ†æ"ï¼‰ã€ç¼ºå°‘æ¡ˆä»¶ç‰¹è‰²

**ç¤ºä¾‹**ï¼š
âœ… å¥½ï¼š
   æ ‡é¢˜ï¼š"ç»¿å­”é›€æ –æ¯åœ°ä¿æŠ¤å…¬ç›Šè¯‰è®¼æ¡ˆ"
   å‰¯æ ‡é¢˜ï¼š"ç¯å¢ƒå…¬ç›Šè¯‰è®¼Â·é¢„é˜²æ€§ç¯ä¿åŸåˆ™çš„å¸æ³•é€‚ç”¨"

âŒ å·®ï¼š
   æ ‡é¢˜ï¼š"æ³•å¾‹æ¡ˆä¾‹æ•™å­¦"
   å‰¯æ ‡é¢˜ï¼š"æ¡ˆä¾‹åˆ†æä¸æ³•å¾‹é€‚ç”¨"

## ğŸ“„ å†…å®¹é¡µï¼ˆtype: contentï¼‰

**æ ‡å‡†**ï¼š
- âœ… æ ‡é¢˜è¯´æ˜"è®²ä»€ä¹ˆæ³•å¾‹é—®é¢˜"ï¼ˆå¦‚"è¿çº¦è´£ä»»çš„æ„æˆè¦ä»¶"ï¼‰
- âœ… è¦ç‚¹å¿…é¡»åŒ…å«æœ¬æ¡ˆçš„å…·ä½“äº‹å®æˆ–æ³•æ¡
- âœ… æ¯é¡µ1ä¸ªæ³•å¾‹è¦ç‚¹ï¼Œä¸è¦æ··æ‚å¤šä¸ªæ¦‚å¿µ
- âŒ é¿å…ï¼šçº¯ç†è®ºæè¿°ã€æ²¡æœ‰ç»“åˆæœ¬æ¡ˆã€ç©ºæ´æ³•å¾‹æœ¯è¯­

**ç¤ºä¾‹**ï¼š
âœ… å¥½ï¼š
   æ ‡é¢˜ï¼š"æœ¬æ¡ˆåŸå‘Šçš„è¯‰è®¼ä¸»ä½“èµ„æ ¼"
   è¦ç‚¹ï¼š
   - åŸå‘Šæ˜¯ç¯ä¿å…¬ç›Šç»„ç»‡
   - å…·å¤‡ã€Šç¯å¢ƒä¿æŠ¤æ³•ã€‹ç¬¬58æ¡è§„å®šçš„èµ„æ ¼
   - è¿ç»­5å¹´ä»äº‹ç¯ä¿å…¬ç›Šæ´»åŠ¨

âŒ å·®ï¼š
   æ ‡é¢˜ï¼š"è¯‰è®¼ä¸»ä½“èµ„æ ¼"
   è¦ç‚¹ï¼š
   - åŸå‘Šéœ€è¦æœ‰è¯‰è®¼èµ„æ ¼
   - ç¬¦åˆæ³•å¾‹è§„å®š
   - æ»¡è¶³ç›¸å…³æ¡ä»¶

## ğŸ“Š å›¾è¡¨é¡µï¼ˆtype: chartï¼‰

**æ ‡å‡†**ï¼š
- âœ… å±•ç¤ºæœ¬æ¡ˆçš„å…·ä½“æ•°æ®ï¼ˆæ—¶é—´è½´ã€å½“äº‹äººå…³ç³»ã€è¯æ®è¯„ä¼°ï¼‰
- âœ… visualHintså¿…é¡»åŒ…å«æœ¬æ¡ˆçš„çœŸå®æ•°æ®
- âœ… å›¾è¡¨ç±»å‹é€‰æ‹©æ­£ç¡®ï¼ˆæ¡ˆä»¶æ—¶é—´â†’timelineï¼Œå½“äº‹äººâ†’networkï¼Œè¯æ®â†’radarï¼‰
- âŒ é¿å…ï¼šè™šæ„æ•°æ®ã€æ³›æ³›è€Œè°ˆã€ä¸ç»“åˆæœ¬æ¡ˆ

**ç¤ºä¾‹**ï¼š
âœ… å¥½ï¼š
   title: "æœ¬æ¡ˆè¯æ®è´¨é‡è¯„ä¼°"
   content: "åŸå‘Šæäº¤çš„5é¡¹å…³é”®è¯æ®åˆ†æ"
   visualHints: "ç”¨é›·è¾¾å›¾å±•ç¤ºè¯æ®è´¨é‡ï¼ˆç¯å¢ƒå½±å“è¯„ä¼°æŠ¥å‘Š-çœŸå®æ€§90%å…³è”æ€§95%ï¼Œä¸“å®¶é‰´å®šæ„è§-çœŸå®æ€§85%å…³è”æ€§88%ï¼Œç°åœºç…§ç‰‡-çœŸå®æ€§95%å…³è”æ€§85%ï¼‰ï¼Œæ ‡æ³¨è¯æ®ä¸‰æ€§æ ‡å‡†"

âŒ å·®ï¼š
   title: "è¯æ®åˆ†æ"
   content: "å±•ç¤ºè¯æ®æƒ…å†µ"
   visualHints: "ç”¨å›¾è¡¨å±•ç¤ºè¯æ®è´¨é‡"

## ğŸ¤” æ€è¾¨é—®é¢˜é¡µï¼ˆtype: contentï¼Œä½†å†…å®¹æ˜¯å¯¹è¯ï¼‰

**æ ‡å‡†**ï¼š
- âœ… å±•ç¤ºè‹æ ¼æ‹‰åº•å¯¹è¯ä¸­çš„å…·ä½“é—®é¢˜å’Œå­¦ç”Ÿå›ç­”
- âœ… æ ‡æ³¨é—®é¢˜èƒŒåçš„æ•™å­¦ç›®çš„
- âœ… ç”¨å¯¹è¯æ¡†æˆ–é—®ç­”æ ¼å¼å¢å¼ºè¡¨ç°åŠ›
- âŒ é¿å…ï¼šåªåˆ—é—®é¢˜ä¸å±•ç¤ºå›ç­”ã€ç¼ºå°‘æ•™å­¦ä»·å€¼è¯´æ˜

**ç¤ºä¾‹**ï¼š
âœ… å¥½ï¼š
   title: "æ€è¾¨ï¼šå¦‚ä½•è®¤å®šé¢„é˜²æ€§ç¯ä¿åŸåˆ™çš„é€‚ç”¨æ¡ä»¶ï¼Ÿ"
   content:
   "ğŸ¤” AIæé—®ï¼š\"æœ¬æ¡ˆä¸­æ°´ç”µç«™å°šæœªå»ºæˆï¼Œç¯å¢ƒæŸå®³è¿˜æœªå‘ç”Ÿï¼ŒåŸå‘Šå‡­ä»€ä¹ˆèµ·è¯‰ï¼Ÿ\"\n\n
   ğŸ’¡ å­¦ç”Ÿå›ç­”ï¼š\"å› ä¸ºæœ‰å¯èƒ½é€ æˆä¸å¯é€†çš„ç”Ÿæ€ç ´å\"\n\n
   ğŸ“š æ•™å­¦ä»·å€¼ï¼šå¼•å¯¼å­¦ç”Ÿç†è§£é¢„é˜²æ€§åŸåˆ™çš„æ ¸å¿ƒâ€”â€”é˜²æ‚£äºæœªç„¶"

âŒ å·®ï¼š
   title: "è¯¾å ‚è®¨è®º"
   content: "è®¨è®ºæ¡ˆä»¶ç›¸å…³é—®é¢˜"

## ğŸ¯ æ€»ç»“é¡µï¼ˆtype: conclusionï¼‰

**æ ‡å‡†**ï¼š
- âœ… æ€»ç»“æœ¬æ¡ˆçš„3ä¸ªæ ¸å¿ƒæ³•å¾‹è¦ç‚¹
- âœ… ç»“åˆå­¦ç”Ÿçš„å­¦ä¹ æ”¶è·
- âœ… æä¾›å®åŠ¡å»ºè®®ï¼ˆé‡åˆ°ç±»ä¼¼æ¡ˆä»¶æ€ä¹ˆåŠï¼‰
- âŒ é¿å…ï¼šç©ºæ³›æ€»ç»“ã€ä¸ç»“åˆæœ¬æ¡ˆã€ç¼ºå°‘å®åŠ¡æŒ‡å¯¼

**ç¤ºä¾‹**ï¼š
âœ… å¥½ï¼š
   æ ‡é¢˜ï¼š"æœ¬æ¡ˆæ ¸å¿ƒè¦ç‚¹ä¸å®åŠ¡å¯ç¤º"
   è¦ç‚¹ï¼š
   - é¢„é˜²æ€§ç¯ä¿åŸåˆ™å¯è¯‰æ€§ï¼ˆæœ¬æ¡ˆé¦–æ¬¡ç¡®è®¤ï¼‰
   - ç¯ä¿ç»„ç»‡çš„è¯‰è®¼ä¸»ä½“èµ„æ ¼è®¤å®š
   - ç±»ä¼¼æ¡ˆä»¶ï¼šæå‰ä»‹å…¥ã€è¯æ®ä¿å…¨ã€ä¸“å®¶è®ºè¯

âŒ å·®ï¼š
   æ ‡é¢˜ï¼š"è¯¾ç¨‹æ€»ç»“"
   è¦ç‚¹ï¼š
   - å­¦ä¹ äº†ç¯å¢ƒæ³•çŸ¥è¯†
   - ç†è§£äº†è¯‰è®¼ç¨‹åº
   - æŒæ¡äº†æ³•å¾‹åˆ†ææ–¹æ³•`;
  }

  /**
   * å¯è§†åŒ–è®¾è®¡æŒ‡å—ï¼ˆè¯¦ç»†ï¼‰
   */
  private buildVisualizationGuide(): string {
    return `# ğŸ“Š å¯è§†åŒ–è®¾è®¡æŒ‡å—

## å›¾è¡¨ç±»å‹é€‰æ‹©å†³ç­–æ ‘

\`\`\`
æ•°æ®ç‰¹å¾ï¼Ÿ
â”œâ”€ æ—¶é—´é¡ºåº â†’ ğŸ“… Timelineï¼ˆæ—¶é—´è½´ï¼‰
â”‚  é€‚ç”¨ï¼šæ¡ˆä»¶å‘å±•ã€å­¦ä¹ è·¯å¾„ã€å†å²è¿›ç¨‹
â”‚  æ•°æ®ï¼š3-15ä¸ªæ—¶é—´èŠ‚ç‚¹
â”‚  ç¤ºä¾‹ï¼švisualHints: "ç”¨æ—¶é—´è½´å±•ç¤ºæ¡ˆä»¶å‘å±•ï¼ˆ2023.01.15 ç­¾è®¢åˆåŒ â†’ 2023.03.20 å‘ç”Ÿçº çº· â†’ 2023.06.10 èµ·è¯‰ â†’ 2023.09.15 åˆ¤å†³ï¼‰"
â”‚
â”œâ”€ å¤šç»´è¯„ä¼° â†’ ğŸ•¸ï¸ Radarï¼ˆé›·è¾¾å›¾ï¼‰
â”‚  é€‚ç”¨ï¼šèƒ½åŠ›è¯„ä¼°ã€è´¨é‡è¯„ä¼°ã€å¤šæŒ‡æ ‡å¯¹æ¯”
â”‚  æ•°æ®ï¼š3-8ä¸ªç»´åº¦ï¼Œæ¯ä¸ªç»´åº¦0-100åˆ†å€¼
â”‚  ç¤ºä¾‹ï¼švisualHints: "ç”¨é›·è¾¾å›¾å±•ç¤ºå­¦ç”Ÿèƒ½åŠ›æå‡ï¼ˆäº‹å®è®¤å®š85åˆ† â†’ 92åˆ†ã€æ³•å¾‹æ¨ç†78åˆ† â†’ 88åˆ†ã€è¯æ®åˆ†æ82åˆ† â†’ 90åˆ†ã€æ‰¹åˆ¤æ€ç»´70åˆ† â†’ 85åˆ†ã€å®åŠ¡åº”ç”¨75åˆ† â†’ 88åˆ†ï¼‰"
â”‚
â”œâ”€ æ•°é‡å¯¹æ¯” â†’ ğŸ“Š Bar/Columnï¼ˆæŸ±çŠ¶å›¾ï¼‰
â”‚  é€‚ç”¨ï¼šå‰åå¯¹æ¯”ã€åˆ†ç±»ç»Ÿè®¡ã€æ’åå±•ç¤º
â”‚  æ•°æ®ï¼š2-10ä¸ªå¯¹æ¯”é¡¹
â”‚  ç¤ºä¾‹ï¼švisualHints: "ç”¨æŸ±çŠ¶å›¾å¯¹æ¯”ä¼ ç»Ÿæ•™å­¦ vs AIè¾…åŠ©æ•™å­¦ï¼ˆè¯¾å ‚äº’åŠ¨æ¬¡æ•°: 8æ¬¡ vs 24æ¬¡ã€å­¦ç”Ÿæé—®æ•°: 3ä¸ª vs 15ä¸ªã€çŸ¥è¯†ç‚¹æŒæ¡ç‡: 65% vs 89%ï¼‰"
â”‚
â”œâ”€ æ¯”ä¾‹æ„æˆ â†’ ğŸ¥§ Pieï¼ˆé¥¼å›¾ï¼‰
â”‚  é€‚ç”¨ï¼šå æ¯”åˆ†æã€æ„æˆå±•ç¤º
â”‚  æ•°æ®ï¼š2-6ä¸ªéƒ¨åˆ†ï¼Œæ€»å’Œ100%
â”‚  ç¤ºä¾‹ï¼švisualHints: "ç”¨é¥¼å›¾å±•ç¤ºå­¦ä¹ æ—¶é—´åˆ†é…ï¼ˆæ¡ˆä¾‹é˜…è¯»25%ã€AIåˆ†æ30%ã€è‹æ ¼æ‹‰åº•è®¨è®º35%ã€æ€»ç»“å¤ä¹ 10%ï¼‰"
â”‚
â”œâ”€ å…³ç³»ç½‘ç»œ â†’ ğŸ”— Networkï¼ˆå…³ç³»å›¾ï¼‰
â”‚  é€‚ç”¨ï¼šå¤šæ–¹å…³ç³»ã€æ³•å¾‹å…³ç³»ã€æ¦‚å¿µå›¾è°±
â”‚  æ•°æ®ï¼š3-10ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹é—´æœ‰è¿æ¥
â”‚  ç¤ºä¾‹ï¼švisualHints: "ç”¨å…³ç³»ç½‘ç»œå›¾å±•ç¤ºå½“äº‹äººæ³•å¾‹å…³ç³»ï¼ˆåŸå‘ŠA â†å€Ÿè´·å…³ç³»â†’ è¢«å‘ŠBï¼Œè¢«å‘ŠB â†æ‹…ä¿å…³ç³»â†’ æ‹…ä¿äººCï¼Œæ‹…ä¿äººC â†å¤«å¦»å…³ç³»â†’ é…å¶Dï¼‰"
â”‚
â””â”€ æµç¨‹æ­¥éª¤ â†’ ğŸ”„ Flowchartï¼ˆæµç¨‹å›¾ï¼‰
   é€‚ç”¨ï¼šæ“ä½œæµç¨‹ã€å†³ç­–æ ‘ã€é€»è¾‘æ¨ç†
   æ•°æ®ï¼š3-8ä¸ªæ­¥éª¤
   ç¤ºä¾‹ï¼švisualHints: "ç”¨æµç¨‹å›¾å±•ç¤ºAIåˆ†ææµç¨‹ï¼ˆä¸Šä¼ æ¡ˆä¾‹æ–‡æ¡£ â†’ AIæå–ä¸‰è¦ç´  â†’ ç”Ÿæˆæ—¶é—´è½´ â†’ è¯†åˆ«äº‰è®®ç„¦ç‚¹ â†’ æ¨èç›¸å…³æ³•æ¡ â†’ ç”Ÿæˆåˆ†ææŠ¥å‘Šï¼‰"
\`\`\`

## visualHintsç¼–å†™è§„èŒƒ

**å¿…é¡»åŒ…å«çš„è¦ç´ **ï¼š
1. å›¾è¡¨ç±»å‹ï¼ˆæ˜ç¡®è¯´æ˜ç”¨ä»€ä¹ˆå›¾ï¼‰
2. å±•ç¤ºå†…å®¹ï¼ˆè¯´æ˜å±•ç¤ºä»€ä¹ˆæ•°æ®ï¼‰
3. å…·ä½“æ•°å€¼ï¼ˆå¿…é¡»æœ‰çœŸå®æ•°æ®ï¼‰
4. è¾…åŠ©è¯´æ˜ï¼ˆæ ‡æ³¨ã€å›¾ä¾‹ã€å•ä½ï¼‰

**æ¨¡æ¿**ï¼š
\`\`\`
ç”¨[å›¾è¡¨ç±»å‹]å±•ç¤º[å±•ç¤ºå†…å®¹]ï¼ˆ[å…·ä½“æ•°å€¼1]ã€[å…·ä½“æ•°å€¼2]ã€[å…·ä½“æ•°å€¼3]ï¼‰ï¼Œ[è¾…åŠ©è¯´æ˜]
\`\`\`

**ç¤ºä¾‹é›†åˆ**ï¼š

âœ… ä¼˜ç§€ç¤ºä¾‹ï¼š
1. "ç”¨é›·è¾¾å›¾å±•ç¤ºè¯æ®è´¨é‡è¯„ä¼°ï¼ˆçœŸå®æ€§85%ã€å…³è”æ€§92%ã€åˆæ³•æ€§78%ã€è¯æ˜åŠ›88%ã€å¯é‡‡æ€§90%ï¼‰ï¼Œæ¯ä¸ªç»´åº¦æ ‡æ³¨è¯„åˆ†ä¾æ®"
2. "ç”¨æ—¶é—´è½´å±•ç¤ºæ¡ˆä»¶å…³é”®èŠ‚ç‚¹ï¼ˆ2023.01.15 ç­¾è®¢åˆåŒã€2023.03.20 è¿çº¦å‘ç”Ÿã€2023.04.05 åå•†å¤±è´¥ã€2023.06.10 æèµ·è¯‰è®¼ã€2023.09.15 ä¸€å®¡åˆ¤å†³ï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ ‡æ³¨æ³•å¾‹æ„ä¹‰"
3. "ç”¨æŸ±çŠ¶å›¾å¯¹æ¯”å­¦ç”Ÿèƒ½åŠ›æå‡ï¼ˆå­¦ä¹ å‰: äº‹å®æ¢³ç†60åˆ†/æ³•å¾‹æ¨ç†55åˆ†/è¯æ®åˆ†æ58åˆ†ï¼Œå­¦ä¹ å: äº‹å®æ¢³ç†88åˆ†/æ³•å¾‹æ¨ç†85åˆ†/è¯æ®åˆ†æ90åˆ†ï¼‰ï¼Œæ ‡æ³¨æå‡å¹…åº¦"

âŒ é”™è¯¯ç¤ºä¾‹ï¼š
1. "ç”¨å›¾è¡¨å±•ç¤º" â† æ²¡è¯´ç”¨ä»€ä¹ˆå›¾
2. "ç”¨é›·è¾¾å›¾å±•ç¤ºè¯æ®è´¨é‡" â† ç¼ºå°‘å…·ä½“æ•°å€¼
3. "å±•ç¤ºæ—¶é—´è½´" â† æ²¡è¯´å±•ç¤ºä»€ä¹ˆå†…å®¹

## æ•°æ®å¯è§†åŒ–çš„é»„é‡‘æ³•åˆ™

1. **æ•°å­—ä¼˜å…ˆ**ï¼šèƒ½é‡åŒ–çš„å¿…é¡»é‡åŒ–
   - âœ… "å­¦ç”Ÿæé—®æ•°å¢åŠ 3å€ï¼ˆ8æ¬¡ â†’ 24æ¬¡ï¼‰"
   - âŒ "å­¦ç”Ÿæé—®æ˜æ˜¾å¢åŠ "

2. **å¯¹æ¯”å‘ˆç°**ï¼šæœ‰å¯¹æ¯”æ‰æœ‰è¯´æœåŠ›
   - âœ… "AIåˆ†æ5åˆ†é’Ÿ vs äººå·¥åˆ†æ2å°æ—¶"
   - âŒ "AIåˆ†æå¾ˆå¿«"

3. **è¶‹åŠ¿å¯è§†**ï¼šå˜åŒ–ç”¨å›¾è¡¨ï¼Œä¸ç”¨æ–‡å­—
   - âœ… "ç”¨æŠ˜çº¿å›¾å±•ç¤ºå­¦ä¹ è¿›æ­¥ï¼ˆç¬¬1å‘¨60åˆ† â†’ ç¬¬4å‘¨88åˆ†ï¼‰"
   - âŒ "å­¦ä¹ æˆç»©ä¸æ–­æé«˜"

4. **å±‚æ¬¡æ¸…æ™°**ï¼šä¸»æ¬¡æ•°æ®è¦åŒºåˆ†
   - ä¸»æ•°æ®ï¼šå¤§å­—ä½“ã€é«˜äº®è‰²
   - æ¬¡æ•°æ®ï¼šå°å­—ä½“ã€æµ…è‰²
   - æ ‡æ³¨ï¼šç°è‰²ã€å°å­—

5. **ç®€æ´è‡³ä¸Š**ï¼šå›¾è¡¨ä¸æ˜¯è¶Šå¤æ‚è¶Šå¥½
   - å•å›¾æ•°æ®ä¸è¶…è¿‡8ä¸ªç»´åº¦
   - é¥¼å›¾åˆ†ç±»ä¸è¶…è¿‡6ä¸ª
   - æŸ±çŠ¶å›¾å¯¹æ¯”ä¸è¶…è¿‡10ç»„`;
  }

  /**
   * æ¨¡æ¿ç‰¹å®šè§„åˆ™
   */
  private buildTemplateSpecificRules(template: PptTemplate): string {
    const rules = {
      'education-bureau': `# ğŸ“š æ¡ˆä¾‹æ•™å­¦åŸºç¡€ç‰ˆè®¾è®¡è§„åˆ™

**å—ä¼—ç”»åƒ**ï¼šæ³•å­¦æœ¬ç§‘ç”Ÿã€åˆå­¦è€…
- å…³æ³¨ï¼šæ¡ˆä»¶æ€ä¹ˆå›äº‹ã€æ³•å¾‹æ€ä¹ˆåˆ†æã€åˆ¤å†³ä¸ºä»€ä¹ˆè¿™æ ·
- å­¦ä¹ ç›®æ ‡ï¼šæŒæ¡æ¡ˆä¾‹åˆ†ææ–¹æ³•ã€ç†è§£æ³•å¾‹æ¨ç†

**è®¾è®¡è¦æ±‚**ï¼š
1. **æ¡ˆæƒ…æ¸…æ™°**
   - ç”¨ç®€å•è¯­è¨€è®²è¿°æ¡ˆä»¶æ•…äº‹
   - å½“äº‹äººå…³ç³»è¦å¯è§†åŒ–ï¼ˆå…³ç³»å›¾ï¼‰
   - æ—¶é—´çº¿è¦æ¸…æ¥šï¼ˆä»€ä¹ˆæ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆï¼‰

2. **æ³•å¾‹è¯¦å®**
   - æ˜ç¡®å¼•ç”¨æ³•æ¡ï¼ˆæ¡æ–‡å·+å†…å®¹ï¼‰
   - è§£é‡Šæ³•å¾‹æœ¯è¯­
   - å±•ç¤ºæ³•å¾‹æ¨ç†è¿‡ç¨‹ï¼ˆä»äº‹å®åˆ°åˆ¤å†³ï¼‰

3. **å­¦ä¹ è®°å½•**
   - å±•ç¤ºå­¦ç”Ÿåœ¨AIå¯¹è¯ä¸­çš„å…³é”®æé—®
   - æ ‡æ³¨å­¦ç”Ÿçš„çªç ´æ€§ç†è§£
   - å·©å›ºå­¦ç”Ÿå·²æŒæ¡çš„çŸ¥è¯†ç‚¹
   - æé†’éœ€è¦è¿›ä¸€æ­¥å­¦ä¹ çš„å†…å®¹

4. **æ‹“å±•å†…å®¹**
   - å¼•ç”¨1-2ä¸ªç±»ä¼¼æ¡ˆä¾‹å¯¹æ¯”
   - æä¾›ç›¸å…³æ³•æ¡ç´¢å¼•
   - æ€»ç»“å®åŠ¡è¦ç‚¹

**é¡µé¢åˆ†é…å»ºè®®**ï¼š
- å°é¢ï¼šæ¡ˆä»¶åç§° (1é¡µ)
- æ¡ˆæƒ…å¯¼å…¥ï¼šåŸºæœ¬ä¿¡æ¯+å½“äº‹äººå…³ç³» (2é¡µ)
- äº‹å®æ¢³ç†ï¼šæ—¶é—´è½´+è¯æ®é“¾ (3-4é¡µ)
- æ³•å¾‹åˆ†æï¼šé€‚ç”¨æ³•å¾‹+è¦ä»¶åˆ†æ+æ¨ç†è¿‡ç¨‹ (5-7é¡µ)
- åˆ¤å†³è§£è¯»ï¼šåˆ¤å†³ç»“æœ+ç†ç”±+æ„ä¹‰ (2-3é¡µ)
- å­¦ç”Ÿå­¦ä¹ å›é¡¾ï¼šå…³é”®æé—®+æŒæ¡çŸ¥è¯†ç‚¹ (2é¡µ)
- æ‹“å±•å­¦ä¹ ï¼šç±»ä¼¼æ¡ˆä¾‹+å®åŠ¡è¦ç‚¹ (2-3é¡µ)
- æ€»ç»“ (1é¡µ)`,

      'teacher-training': `# ğŸ‘¨â€ğŸ« æ•™å¸ˆåŸ¹è®­ç‰ˆè®¾è®¡è§„åˆ™

**å—ä¼—ç”»åƒ**ï¼šæ³•å­¦æ•™å¸ˆã€åŸ¹è®­å¯¹è±¡
- å…³æ³¨ï¼šå¦‚ä½•ä½¿ç”¨ã€æ“ä½œæµç¨‹ã€æ•™å­¦æŠ€å·§
- å­¦ä¹ ç›®æ ‡ï¼šæŒæ¡å¹³å°ä½¿ç”¨ã€æå‡æ•™å­¦èƒ½åŠ›

**è®¾è®¡è¦æ±‚**ï¼š
1. **æ“ä½œæ€§å¼º**
   - æ¯ä¸ªåŠŸèƒ½éƒ½æœ‰ä½¿ç”¨è¯´æ˜
   - é…åˆæˆªå›¾æˆ–æ“ä½œæµç¨‹å›¾
   - æ ‡æ³¨å…³é”®æ­¥éª¤å’Œæ³¨æ„äº‹é¡¹

2. **æ¡ˆä¾‹é©±åŠ¨**
   - ç”¨çœŸå®æ¡ˆä¾‹æ¼”ç¤ºåŠŸèƒ½
   - å±•ç¤ºå®Œæ•´çš„æ•™å­¦æµç¨‹
   - æä¾›å¯å¤åˆ¶çš„æ•™å­¦èŒƒä¾‹

3. **æŠ€å·§æç‚¼**
   - æ€»ç»“æœ€ä½³å®è·µï¼ˆBest Practicesï¼‰
   - æä¾›æ•™å­¦è¯æœ¯æ¨¡æ¿
   - åˆ†äº«å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

**é¡µé¢åˆ†é…å»ºè®®**ï¼š
- å°é¢ (1é¡µ)
- å¹³å°ä»‹ç» (2é¡µ)
- æ“ä½œæµç¨‹ (6-8é¡µ)ï¼šåˆ†æ­¥è®²è§£
- æ•™å­¦æ¡ˆä¾‹ (3-4é¡µ)ï¼šå®Œæ•´æ¼”ç¤º
- æŠ€å·§æ€»ç»“ (2-3é¡µ)
- Q&A (1-2é¡µ)`,

      'school-leadership': `# ğŸ« å­¦æ ¡é¢†å¯¼æ±‡æŠ¥ç‰ˆè®¾è®¡è§„åˆ™

**å—ä¼—ç”»åƒ**ï¼šå­¦æ ¡é¢†å¯¼ã€æ•™å­¦ä¸»ç®¡
- å…³æ³¨ï¼šæ•™å­¦æ•ˆæœã€å­¦ç”Ÿè¡¨ç°ã€è¯¾ç¨‹äº®ç‚¹
- å†³ç­–ä¾æ®ï¼šå­¦ç”Ÿåé¦ˆã€æˆç»©æå‡ã€èµ„æºæŠ•å…¥

**è®¾è®¡è¦æ±‚**ï¼š
1. **æˆæœå¯¼å‘**
   - çªå‡ºå­¦ç”Ÿèƒ½åŠ›æå‡
   - å±•ç¤ºè¯¾å ‚äº’åŠ¨æ•°æ®
   - å¯¹æ¯”ä¼ ç»Ÿæ•™å­¦æ•ˆæœ

2. **å­¦ç”Ÿè§†è§’**
   - å±•ç¤ºå­¦ç”Ÿå­¦ä¹ è·¯å¾„
   - å¼•ç”¨å­¦ç”Ÿåé¦ˆ
   - å±•ç¤ºå­¦ç”Ÿä½œå“/æˆæœ

3. **èµ„æºæ•ˆç‡**
   - è¯´æ˜æ•™å¸ˆå·¥ä½œé‡å˜åŒ–
   - å±•ç¤ºæ—¶é—´æˆæœ¬èŠ‚çº¦
   - åˆ†ææŠ•å…¥äº§å‡ºæ¯”

**é¡µé¢åˆ†é…å»ºè®®**ï¼š
- å°é¢ (1é¡µ)
- è¯¾ç¨‹æ¦‚å†µ (2é¡µ)
- æ•™å­¦è¿‡ç¨‹ (4-5é¡µ)ï¼šå››å¹•å±•ç¤º
- å­¦ç”Ÿè¡¨ç° (3-4é¡µ)ï¼šæ•°æ®å’Œæ¡ˆä¾‹
- æ•ˆæœå¯¹æ¯” (2é¡µ)
- èµ„æºåˆ†æ (1é¡µ)
- æ€»ç»“å»ºè®® (1é¡µ)`,

      'parent-meeting': `# ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶é•¿ä¼šå±•ç¤ºç‰ˆè®¾è®¡è§„åˆ™

**å—ä¼—ç”»åƒ**ï¼šå­¦ç”Ÿå®¶é•¿
- å…³æ³¨ï¼šå­©å­å­¦åˆ°äº†ä»€ä¹ˆã€èƒ½åŠ›æå‡ã€å­¦ä¹ å…´è¶£
- ç†è§£æ°´å¹³ï¼šéä¸“ä¸šï¼Œéœ€è¦é€šä¿—åŒ–è¡¨è¾¾

**è®¾è®¡è¦æ±‚**ï¼š
1. **é€šä¿—æ˜“æ‡‚**
   - é¿å…ä¸“ä¸šæœ¯è¯­ï¼ˆæˆ–åŠ æ³¨é‡Šï¼‰
   - ç”¨ç”Ÿæ´»åŒ–çš„æ¯”å–»
   - å¤šç”¨å›¾ç‰‡å’Œå›¾è¡¨ï¼Œå°‘ç”¨æ–‡å­—

2. **å­¦ç”Ÿæˆæœ**
   - å±•ç¤ºå…·ä½“çš„å­¦ä¹ æ”¶è·
   - å¯¹æ¯”å­¦ä¹ å‰åå˜åŒ–
   - å±•ç¤ºå­¦ç”Ÿä½œå“æˆ–å¯¹è¯ç‰‡æ®µ

3. **å¯è§†åŒ–å¼º**
   - å¤§é‡ä½¿ç”¨å›¾è¡¨
   - å¯¹è¯æ¡†å±•ç¤ºäº’åŠ¨
   - ç”¨å›¾ç‰‡å¢å¼ºå¯è¯»æ€§

4. **æƒ…æ„Ÿå…±é¸£**
   - çªå‡ºå­©å­çš„è¿›æ­¥
   - å±•ç¤ºå­¦ä¹ çš„ä¹è¶£
   - ä¼ é€’æ­£é¢çš„æ•™è‚²ç†å¿µ

**é¡µé¢åˆ†é…å»ºè®®**ï¼š
- å°é¢ (1é¡µ)
- è¯¾ç¨‹ä»‹ç» (1é¡µ)ï¼šç®€å•æ˜äº†
- å­¦ä¹ è¿‡ç¨‹ (4-5é¡µ)ï¼šå›¾æ–‡å¹¶èŒ‚
- å­©å­çš„æ”¶è· (3-4é¡µ)ï¼šå…·ä½“å±•ç¤º
- èƒ½åŠ›æå‡ (2é¡µ)ï¼šå¯è§†åŒ–å¯¹æ¯”
- æœªæ¥è®¡åˆ’ (1é¡µ)`,

      'academic-conference': `# ğŸ“ å­¦æœ¯ä¼šè®®ç‰ˆè®¾è®¡è§„åˆ™

**å—ä¼—ç”»åƒ**ï¼šæ³•å­¦ä¸“å®¶ã€æ•™è‚²å­¦è€…ã€åŒè¡Œç ”ç©¶è€…
- å…³æ³¨ï¼šæ•™å­¦æ–¹æ³•åˆ›æ–°ã€ç†è®ºæ·±åº¦ã€å­¦æœ¯ä»·å€¼
- è¯„ä»·æ ‡å‡†ï¼šä¸¥è°¨æ€§ã€åˆ›æ–°æ€§ã€å¯éªŒè¯æ€§

**è®¾è®¡è¦æ±‚**ï¼š
1. **å­¦æœ¯ä¸¥è°¨**
   - å¼•ç”¨ç†è®ºåŸºç¡€å’Œæ–‡çŒ®
   - è¯´æ˜ç ”ç©¶æ–¹æ³•å’Œå®éªŒè®¾è®¡
   - å±•ç¤ºæ•°æ®åˆ†æå’Œç»Ÿè®¡ç»“æœ

2. **æ–¹æ³•åˆ›æ–°**
   - æ˜ç¡®åˆ›æ–°ç‚¹ï¼ˆvs ä¼ ç»Ÿæ–¹æ³•ï¼‰
   - ç†è®ºè´¡çŒ®ï¼ˆå¯¹æ•™å­¦ç†è®ºçš„è¡¥å……ï¼‰
   - å®è·µä»·å€¼ï¼ˆå¯å¤åˆ¶æ€§éªŒè¯ï¼‰

3. **æ•°æ®å……åˆ†**
   - å®éªŒæ•°æ®ï¼ˆæ ·æœ¬é‡ã€å¯¹ç…§ç»„ï¼‰
   - ç»Ÿè®¡åˆ†æï¼ˆæ˜¾è‘—æ€§æ£€éªŒï¼‰
   - æ•ˆæœéªŒè¯ï¼ˆå¤šç»´åº¦è¯„ä¼°ï¼‰

**é¡µé¢åˆ†é…å»ºè®®**ï¼š
- å°é¢ (1é¡µ)
- ç ”ç©¶èƒŒæ™¯ (2-3é¡µ)ï¼šæ–‡çŒ®ç»¼è¿°
- ç†è®ºæ¡†æ¶ (2é¡µ)ï¼šè‹æ ¼æ‹‰åº•æ•™å­¦æ³•+AI
- æ–¹æ³•è®¾è®¡ (3-4é¡µ)ï¼šå››å¹•æ•™å­¦æ³•
- å®éªŒç»“æœ (4-5é¡µ)ï¼šæ•°æ®åˆ†æ
- è®¨è®º (2-3é¡µ)ï¼šç†è®ºå’Œå®è·µæ„ä¹‰
- ç»“è®º (1é¡µ)`,

      'technical': `# ğŸ’» æŠ€æœ¯è¯„å®¡ç‰ˆè®¾è®¡è§„åˆ™

**å—ä¼—ç”»åƒ**ï¼šæŠ€æœ¯äººå‘˜ã€æ¶æ„å¸ˆã€CTO
- å…³æ³¨ï¼šæŠ€æœ¯æ¶æ„ã€å®ç°ç»†èŠ‚ã€ä»£ç è´¨é‡
- è¯„ä»·æ ‡å‡†ï¼šå¯æ‰©å±•æ€§ã€æ€§èƒ½ã€å®‰å…¨æ€§

**è®¾è®¡è¦æ±‚**ï¼š
1. **æ¶æ„æ¸…æ™°**
   - ç³»ç»Ÿæ¶æ„å›¾
   - æŠ€æœ¯æ ˆè¯´æ˜
   - æ¨¡å—åˆ’åˆ†é€»è¾‘

2. **å®ç°ç»†èŠ‚**
   - æ ¸å¿ƒç®—æ³•ï¼ˆAIæ¨¡å‹ã€NLPå¤„ç†ï¼‰
   - æ•°æ®æµç¨‹ï¼ˆå››å¹•æ•°æ®ä¼ é€’ï¼‰
   - æ€§èƒ½ä¼˜åŒ–ï¼ˆå“åº”æ—¶é—´ã€å¹¶å‘å¤„ç†ï¼‰

3. **ä»£ç è´¨é‡**
   - è®¾è®¡æ¨¡å¼
   - æµ‹è¯•è¦†ç›–ç‡
   - ä»£ç è§„èŒƒ

**é¡µé¢åˆ†é…å»ºè®®**ï¼š
- å°é¢ (1é¡µ)
- ç³»ç»Ÿæ¶æ„ (3-4é¡µ)
- æŠ€æœ¯å®ç° (5-6é¡µ)ï¼šåˆ†æ¨¡å—è®²è§£
- æ€§èƒ½åˆ†æ (2é¡µ)
- å®‰å…¨è®¾è®¡ (1-2é¡µ)
- æœªæ¥è§„åˆ’ (1é¡µ)`
    };

    return rules[template];
  }

  /**
   * è¾“å‡ºæ ¼å¼è¯´æ˜ï¼ˆç›´æ¥ç”Ÿæˆ302.ai Markdownï¼‰
   */
  private buildOutputFormat(): string {
    return `# ğŸ“ è¾“å‡ºæ ¼å¼è¦æ±‚

## Markdownæ ¼å¼ï¼ˆç›´æ¥ç”Ÿæˆï¼Œæ— éœ€JSONè½¬æ¢ï¼‰

**ç›´æ¥æŒ‰ä»¥ä¸‹Markdownæ ¼å¼è¾“å‡ºï¼Œ302.aiä¼šè‡ªåŠ¨è§£ææˆPPT**ï¼š

\`\`\`markdown
# æ³•å¾‹æ¡ˆä¾‹æ•™å­¦è¯¾ä»¶

## æ¡ˆä»¶åç§°ï¼šç»¿å­”é›€æ –æ¯åœ°ä¿æŠ¤å…¬ç›Šè¯‰è®¼æ¡ˆ

ç¯å¢ƒå…¬ç›Šè¯‰è®¼Â·é¢„é˜²æ€§ç¯ä¿åŸåˆ™çš„å¸æ³•é€‚ç”¨

---

## æ¡ˆä»¶åŸºæœ¬ä¿¡æ¯

- æ¡ˆä»¶ç±»å‹ï¼šç¯å¢ƒå…¬ç›Šè¯‰è®¼
- åŸå‘Šï¼šæŸç¯ä¿ç»„ç»‡
- è¢«å‘Šï¼šæ°´ç”µç«™å»ºè®¾æ–¹
- æ ¸å¿ƒäº‰è®®ï¼šæ°´ç”µç«™å»ºè®¾å¯èƒ½å¯¼è‡´ç»¿å­”é›€æ –æ¯åœ°ç ´å

---

## æ¡ˆä»¶æ—¶é—´è½´

> ğŸ’¡ è®¾è®¡æç¤ºï¼šç”¨æ—¶é—´è½´å±•ç¤ºæ¡ˆä»¶å‘å±•ï¼ˆ2020.03.15 æ°´ç”µç«™ç«‹é¡¹ â†’ 2020.06.20 ç¯ä¿ç»„ç»‡æèµ·è¯‰è®¼ â†’ 2020.09.10 æ³•é™¢è£å®šæš‚åœæ–½å·¥ â†’ 2021.02.15 ä¸€å®¡åˆ¤å†³ï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ ‡æ³¨æ³•å¾‹æ„ä¹‰

- 2020.03.15ï¼šæ°´ç”µç«™é¡¹ç›®ç«‹é¡¹
- 2020.06.20ï¼šç¯ä¿ç»„ç»‡æèµ·å…¬ç›Šè¯‰è®¼
- 2020.09.10ï¼šæ³•é™¢è£å®šæš‚åœæ–½å·¥
- 2021.02.15ï¼šä¸€å®¡åˆ¤å†³æ”¯æŒåŸå‘Š

---

## æ€è¾¨ï¼šé¢„é˜²æ€§ç¯ä¿åŸåˆ™çš„é€‚ç”¨

ğŸ¤” **AIæé—®**ï¼š"æœ¬æ¡ˆä¸­æ°´ç”µç«™å°šæœªå»ºæˆï¼Œç¯å¢ƒæŸå®³è¿˜æœªå‘ç”Ÿï¼ŒåŸå‘Šå‡­ä»€ä¹ˆèµ·è¯‰ï¼Ÿ"

ğŸ’¡ **å­¦ç”Ÿå›ç­”**ï¼š"å› ä¸ºæœ‰å¯èƒ½é€ æˆä¸å¯é€†çš„ç”Ÿæ€ç ´å"

ğŸ“š **æ•™å­¦ä»·å€¼**ï¼šå¼•å¯¼å­¦ç”Ÿç†è§£é¢„é˜²æ€§åŸåˆ™çš„æ ¸å¿ƒâ€”â€”é˜²æ‚£äºæœªç„¶

---

## æœ¬æ¡ˆæ ¸å¿ƒè¦ç‚¹

- é¢„é˜²æ€§ç¯ä¿åŸåˆ™é¦–æ¬¡å¸æ³•ç¡®è®¤
- ç¯ä¿ç»„ç»‡è¯‰è®¼ä¸»ä½“èµ„æ ¼è®¤å®š
- ç±»ä¼¼æ¡ˆä»¶å®åŠ¡å»ºè®®ï¼šæå‰ä»‹å…¥ã€è¯æ®ä¿å…¨

---
\`\`\`

## å…³é”®è§„åˆ™ï¼ˆç®€åŒ–åï¼‰

### 1. é¡µé¢ç»“æ„
- **\`## æ ‡é¢˜\`** = ä¸€é¡µPPTçš„æ ‡é¢˜
- **\`---\`** = é¡µé¢åˆ†éš”ç¬¦
- **åˆ—è¡¨** = é¡µé¢è¦ç‚¹å†…å®¹

### 2. è®¾è®¡æç¤ºï¼ˆé‡è¦ï¼ï¼‰
æ ¼å¼ï¼š\`> ğŸ’¡ è®¾è®¡æç¤ºï¼šç”¨[å›¾è¡¨ç±»å‹]å±•ç¤º[å†…å®¹]ï¼ˆ[å…·ä½“æ•°å€¼]ï¼‰ï¼Œ[è¾…åŠ©è¯´æ˜]\`

**æˆåŠŸç¤ºä¾‹**ï¼š
- âœ… \`> ğŸ’¡ è®¾è®¡æç¤ºï¼šç”¨æ—¶é—´è½´å±•ç¤ºæ¡ˆä»¶å‘å±•ï¼ˆ2023.01.15 ç­¾è®¢åˆåŒ â†’ 2023.03.20 è¿çº¦ â†’ 2023.06.10 èµ·è¯‰ï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ ‡æ³¨æ³•å¾‹æ„ä¹‰\`
- âœ… \`> ğŸ’¡ è®¾è®¡æç¤ºï¼šç”¨é›·è¾¾å›¾å±•ç¤ºè¯æ®è´¨é‡ï¼ˆçœŸå®æ€§85%ã€å…³è”æ€§92%ã€åˆæ³•æ€§78%ï¼‰ï¼Œæ ‡æ³¨è¯„åˆ†ä¾æ®\`

**å¤±è´¥ç¤ºä¾‹**ï¼š
- âŒ \`> ğŸ’¡ è®¾è®¡æç¤ºï¼šç”¨å›¾è¡¨å±•ç¤º\` ï¼ˆç¼ºå°‘å…·ä½“æ•°æ®ï¼‰

### 3. é¡µé¢è¦æ±‚
- æ ‡é¢˜ï¼š8-12å­—
- è¦ç‚¹ï¼šæ¯ç‚¹ä¸è¶…è¿‡15å­—ï¼Œæ¯é¡µä¸è¶…è¿‡3ä¸ªè¦ç‚¹
- å›¾è¡¨é¡µï¼šå¿…é¡»æœ‰è®¾è®¡æç¤º

### 4. è´¨é‡æ ‡å‡†
- âœ… å…·ä½“æ³•æ¡å¼•ç”¨ï¼ˆå¦‚"ã€Šç¯å¢ƒä¿æŠ¤æ³•ã€‹ç¬¬58æ¡"ï¼‰
- âœ… å…·ä½“æ¡ˆä»¶äº‹å®ï¼ˆä¸è¦åªè¯´"å‘ç”Ÿçº çº·"ï¼‰
- âœ… çœŸå®æ•°æ®ï¼ˆæ—¶é—´ã€ç™¾åˆ†æ¯”ã€æ•°é‡ï¼‰
- âŒ é¿å…ç©ºæ³›ç†è®ºå’Œé€šç”¨æè¿°

## ä¸¥æ ¼è¦æ±‚

- âœ… **ç›´æ¥è¾“å‡ºMarkdownæ–‡æœ¬**ï¼Œä¸è¦æ·»åŠ \`\`\`markdown\`æ ‡è®°
- âœ… æ¯é¡µç”¨\`---\`åˆ†éš”
- âœ… å›¾è¡¨é¡µå¿…é¡»åŒ…å«è¯¦ç»†çš„è®¾è®¡æç¤º
- âœ… æ‰€æœ‰å†…å®¹åŸºäºç”¨æˆ·æä¾›çš„çœŸå®æ•°æ®`;
  }

  /**
   * æ„å»ºUser Promptï¼ˆä½¿ç”¨æå–åçš„å…³é”®è¦ç´ ï¼‰
   */
  buildUserPrompt(options: PptPromptOptions): string {
    const { keyElements, template, length = 'medium', includeDialogue = true } = options;

    const sections: string[] = [];

    // æ¡ˆä¾‹æ ¸å¿ƒä¿¡æ¯
    sections.push(this.formatCaseEssence(keyElements));

    // æ•™å­¦äº®ç‚¹
    sections.push(this.formatTeachingHighlights(keyElements));

    // å¯¹è¯ç²¾åï¼ˆå¯é€‰ï¼‰
    if (includeDialogue) {
      sections.push(this.formatDialogueHighlights(keyElements));
    }

    // å­¦ä¹ æˆæœ
    sections.push(this.formatLearningOutcomes(keyElements));

    // ä»»åŠ¡æŒ‡ä»¤
    sections.push(this.buildTaskInstruction(template, length));

    return sections.join('\n\n---\n\n');
  }

  /**
   * æ ¼å¼åŒ–æ¡ˆä¾‹æ ¸å¿ƒä¿¡æ¯
   */
  private formatCaseEssence(keyElements: PptKeyElements): string {
    const { caseEssence } = keyElements;

    return `## ğŸ“‹ æ¡ˆä¾‹æ ¸å¿ƒä¿¡æ¯

**æ¡ˆä»¶åç§°**ï¼š${caseEssence.title}

**æ¡ˆä»¶ç±»å‹**ï¼š${caseEssence.type}

**å½“äº‹äºº**ï¼š
- åŸå‘Šï¼š${caseEssence.parties.plaintiff}
- è¢«å‘Šï¼š${caseEssence.parties.defendant}

**æ ¸å¿ƒäº‰è®®**ï¼š${caseEssence.mainDispute}

**æ³•å¾‹é—®é¢˜**ï¼š${caseEssence.legalIssue}

**åˆ¤å†³ç»“æœ**ï¼š${caseEssence.verdict}`;
  }

  /**
   * æ ¼å¼åŒ–æ•™å­¦äº®ç‚¹ï¼ˆç¬¬äºŒå¹•æ·±åº¦åˆ†æçš„å®Œæ•´æ•°æ®ï¼‰
   */
  private formatTeachingHighlights(keyElements: PptKeyElements): string {
    const { teachingHighlights } = keyElements;

    let result = `## ğŸ’¡ ç¬¬äºŒå¹•æ·±åº¦åˆ†æå†…å®¹ï¼ˆå¿…é¡»åŸºäºè¿™äº›å…·ä½“æ•°æ®ç”ŸæˆPPTï¼‰

### ğŸ“Š äº‹å®åˆ†æ`;

    // å…³é”®äº‹å®
    if (teachingHighlights.factAnalysis.keyFacts.length > 0) {
      result += `\n\n**å…³é”®äº‹å®**ï¼ˆPPTä¸­å¿…é¡»å±•ç¤ºï¼‰ï¼š\n`;
      teachingHighlights.factAnalysis.keyFacts.forEach((fact, i) => {
        result += `${i + 1}. ${fact}\n`;
      });
    }

    // äº‰è®®ç„¦ç‚¹
    if (teachingHighlights.factAnalysis.disputedPoints.length > 0) {
      result += `\n**äº‰è®®ç„¦ç‚¹**ï¼ˆPPTä¸­å¿…é¡»é€ä¸€åˆ†æï¼‰ï¼š\n`;
      teachingHighlights.factAnalysis.disputedPoints.forEach((point, i) => {
        result += `${i + 1}. ${point}\n`;
      });
    }

    // æ—¶é—´è½´
    if (teachingHighlights.factAnalysis.timeline.length > 0) {
      result += `\n**æ¡ˆä»¶æ—¶é—´è½´**ï¼ˆå¿…é¡»ç”¨timelineå¯è§†åŒ–ï¼‰ï¼š\n`;
      teachingHighlights.factAnalysis.timeline.forEach(event => {
        result += `- ${event.date}: ${event.event} [${event.importance === 'critical' ? 'å…³é”®' : event.importance === 'important' ? 'é‡è¦' : 'æ™®é€š'}]\n`;
      });
    }

    // è¯æ®åˆ†æ
    result += `\n\n### ğŸ” è¯æ®åˆ†æ`;

    if (teachingHighlights.evidenceAnalysis.strengths.length > 0) {
      result += `\n\n**è¯æ®ä¼˜åŠ¿**ï¼ˆPPTä¸­å¿…é¡»åˆ—ä¸¾ï¼‰ï¼š\n`;
      teachingHighlights.evidenceAnalysis.strengths.forEach((strength, i) => {
        result += `${i + 1}. ${strength}\n`;
      });
    }

    if (teachingHighlights.evidenceAnalysis.weaknesses.length > 0) {
      result += `\n**è¯æ®å¼±ç‚¹**ï¼ˆPPTä¸­å¿…é¡»æŒ‡å‡ºï¼‰ï¼š\n`;
      teachingHighlights.evidenceAnalysis.weaknesses.forEach((weakness, i) => {
        result += `${i + 1}. ${weakness}\n`;
      });
    }

    if (teachingHighlights.evidenceAnalysis.recommendations.length > 0) {
      result += `\n**æ”¹è¿›å»ºè®®**ï¼ˆPPTä¸­ç»™å‡ºå®åŠ¡å»ºè®®ï¼‰ï¼š\n`;
      teachingHighlights.evidenceAnalysis.recommendations.forEach((rec, i) => {
        result += `${i + 1}. ${rec}\n`;
      });
    }

    // æ³•å¾‹åˆ†æ
    result += `\n\n### âš–ï¸ æ³•å¾‹åˆ†æ`;

    if (teachingHighlights.legalAnalysis.applicableLaws.length > 0) {
      result += `\n\n**é€‚ç”¨æ³•å¾‹**ï¼ˆPPTä¸­å¿…é¡»å¼•ç”¨å…·ä½“æ³•æ¡ï¼‰ï¼š\n`;
      teachingHighlights.legalAnalysis.applicableLaws.forEach((law, i) => {
        result += `${i + 1}. ${law}\n`;
      });
    }

    if (teachingHighlights.legalAnalysis.precedents.length > 0) {
      result += `\n**åˆ¤ä¾‹å‚è€ƒ**ï¼ˆPPTä¸­å¼•ç”¨ç±»ä¼¼æ¡ˆä¾‹ï¼‰ï¼š\n`;
      teachingHighlights.legalAnalysis.precedents.forEach((precedent, i) => {
        result += `${i + 1}. ${precedent}\n`;
      });
    }

    if (teachingHighlights.legalAnalysis.risks.length > 0) {
      result += `\n**æ³•å¾‹é£é™©**ï¼ˆPPTä¸­å¿…é¡»æé†’ï¼‰ï¼š\n`;
      teachingHighlights.legalAnalysis.risks.forEach((risk, i) => {
        result += `${i + 1}. ${risk}\n`;
      });
    }

    // å¯è§†åŒ–æ•°æ®
    if (teachingHighlights.visualizableData.length > 0) {
      result += `\n\n### ğŸ“ˆ å¯è§†åŒ–æ•°æ®ï¼ˆå¿…é¡»ç”¨å›¾è¡¨å±•ç¤ºï¼‰\n`;
      teachingHighlights.visualizableData.forEach(chart => {
        result += `\n**${chart.title}** [${chart.type}å›¾]\n`;
        result += `- æ•°æ®ï¼š${JSON.stringify(chart.data)}\n`;
        result += `- visualHintsæç¤ºï¼š${chart.description}\n`;
      });
    }

    result += `\n\nâš ï¸ **é‡è¦æç¤º**ï¼š
1. ä»¥ä¸Šæ‰€æœ‰æ•°æ®éƒ½æ˜¯æ¥è‡ªç¬¬äºŒå¹•æ·±åº¦åˆ†æçš„çœŸå®å†…å®¹
2. PPTå¤§çº²å¿…é¡»åŸºäºè¿™äº›å…·ä½“æ•°æ®ç”Ÿæˆï¼Œä¸èƒ½ç”¨é€šç”¨æè¿°ä»£æ›¿
3. å…³é”®äº‹å®ã€äº‰è®®ç„¦ç‚¹ã€æ³•æ¡å¼•ç”¨ã€åˆ¤ä¾‹å‚è€ƒç­‰éƒ½å¿…é¡»åœ¨PPTä¸­ä½“ç°
4. æ—¶é—´è½´ã€è¯æ®åˆ†æç­‰å¿…é¡»ç”¨å¯è§†åŒ–å›¾è¡¨å±•ç¤º`;

    return result;
  }

  /**
   * æ ¼å¼åŒ–å¯¹è¯ç²¾åï¼ˆå¼ºåŒ–æ€è¾¨é—®é¢˜å±•ç¤ºï¼‰
   */
  private formatDialogueHighlights(keyElements: PptKeyElements): string {
    const { dialogueHighlights } = keyElements;

    let result = `## ğŸ’¬ è‹æ ¼æ‹‰åº•å¯¹è¯ç²¾åï¼ˆç¬¬ä¸‰å¹•ï¼‰

**å­¦ç”Ÿæ€ç»´è¿›æ­¥è·¯å¾„**ï¼š
${dialogueHighlights.thinkingProgression}`;

    if (dialogueHighlights.keyQuestions.length > 0) {
      result += `\n\n**å…³é”®æ€è¾¨é—®é¢˜ä¸å¯¹è¯**ï¼ˆPPTä¸­å¿…é¡»å±•ç¤ºè¿™äº›é—®é¢˜ï¼‰ï¼š\n`;
      dialogueHighlights.keyQuestions.forEach((q, i) => {
        result += `\n${i + 1}. ğŸ¤” **æ€è¾¨é—®é¢˜**ï¼š"${q.question}"\n`;
        result += `   ğŸ’¡ **å­¦ç”Ÿå›ç­”**ï¼š"${q.studentResponse}"\n`;
        result += `   ğŸ“š **æ•™å­¦ä»·å€¼**ï¼š${q.insight}\n`;
        result += `   \n   ğŸ’¡ **PPTå‘ˆç°å»ºè®®**ï¼šç”¨é—®ç­”æ¡†å±•ç¤ºï¼Œçªå‡ºæ€è¾¨æ€§å’Œå­¦ç”Ÿçš„æ€è€ƒè¿‡ç¨‹\n`;
      });
    }

    if (dialogueHighlights.breakthroughMoments.length > 0) {
      result += `\n\n**å­¦ç”Ÿçš„çªç ´æ€§ç†è§£æ—¶åˆ»**ï¼š\n`;
      dialogueHighlights.breakthroughMoments.forEach(moment => {
        result += `- âœ¨ ${moment}\n`;
      });
    }

    result += `\n\nâš ï¸ **é‡è¦æç¤º**ï¼šè‹æ ¼æ‹‰åº•å¯¹è¯çš„æ€è¾¨é—®é¢˜æ˜¯æ•™å­¦çš„æ ¸å¿ƒäº®ç‚¹ï¼ŒPPTä¸­å¿…é¡»ï¼š
1. ç”¨ç‹¬ç«‹é¡µé¢å±•ç¤ºå…³é”®æ€è¾¨é—®é¢˜
2. å±•ç¤ºå­¦ç”Ÿçš„å›ç­”å’Œæ€è€ƒè¿‡ç¨‹
3. æ ‡æ³¨é—®é¢˜èƒŒåçš„æ•™å­¦ç›®çš„
4. å¯ä»¥ç”¨å¯¹è¯æ¡†ã€é—®ç­”å¡ç‰‡ç­‰è§†è§‰å…ƒç´ å¢å¼ºè¡¨ç°åŠ›`;

    return result;
  }

  /**
   * æ ¼å¼åŒ–å­¦ä¹ æˆæœ
   */
  private formatLearningOutcomes(keyElements: PptKeyElements): string {
    const { learningOutcomes } = keyElements;

    let result = `## ğŸ“ å­¦ä¹ æˆæœ

**å…³é”®æ”¶è·**ï¼š
${learningOutcomes.keyInsights.map(insight => `- ${insight}`).join('\n')}

**èƒ½åŠ›æå‡**ï¼š
${learningOutcomes.skillsImproved.map(skill => `- ${skill}`).join('\n')}`;

    if (learningOutcomes.knowledgeGaps.length > 0) {
      result += `\n\n**çŸ¥è¯†ç›²åŒºï¼ˆéœ€è¦è¿›ä¸€æ­¥å­¦ä¹ ï¼‰**ï¼š\n`;
      result += learningOutcomes.knowledgeGaps.map(gap => `- ${gap}`).join('\n');
    }

    return result;
  }

  /**
   * æ„å»ºä»»åŠ¡æŒ‡ä»¤
   */
  private buildTaskInstruction(template: PptTemplate, length: 'short' | 'medium' | 'long'): string {
    const pageRanges = {
      short: '10-15é¡µ',
      medium: '20-25é¡µ',
      long: '25-35é¡µ'
    };

    const templateNames: Record<PptTemplate, string> = {
      'education-bureau': 'æ¡ˆä¾‹æ•™å­¦åŸºç¡€ç‰ˆ',
      'teacher-training': 'æ¡ˆä¾‹æ•™å­¦è¿›é˜¶ç‰ˆ',
      'school-leadership': 'æ¡ˆä¾‹æ•™å­¦è€ƒè¯•ç‰ˆ',
      'parent-meeting': 'æ¡ˆä¾‹æ•™å­¦ç®€åŒ–ç‰ˆ',
      'academic-conference': 'æ¡ˆä¾‹æ•™å­¦å­¦æœ¯ç‰ˆ',
      'technical': 'æ¡ˆä¾‹æ•™å­¦å®åŠ¡ç‰ˆ'
    };

    return `## ğŸ“‹ ä½ çš„ä»»åŠ¡

åŸºäºä»¥ä¸Šæ¡ˆä»¶ä¿¡æ¯å’Œå­¦ä¹ è®°å½•ï¼Œç”Ÿæˆä¸€ä»½**${templateNames[template]}**æ³•å¾‹æ¡ˆä¾‹æ•™å­¦è¯¾ä»¶ã€‚

**æ ¸å¿ƒè¦æ±‚**ï¼š
1. é¡µæ•°ï¼š${pageRanges[length]}
2. **æ¡ˆä»¶ä¸ºä¸­å¿ƒ**ï¼šæ‰€æœ‰å†…å®¹å›´ç»•è¿™ä¸ªå…·ä½“æ¡ˆä»¶ï¼Œä¸è¦ç©ºè°ˆç†è®º
3. **æ³•å¾‹ç»†èŠ‚**ï¼š
   - å¿…é¡»å¼•ç”¨å…·ä½“æ³•æ¡ï¼ˆå¦‚"ã€ŠåˆåŒæ³•ã€‹ç¬¬107æ¡"ï¼‰
   - å¿…é¡»å±•ç¤ºæ³•å¾‹æ¨ç†è¿‡ç¨‹ï¼ˆä»äº‹å®åˆ°æ³•å¾‹è¦ä»¶åˆ°åˆ¤å†³ï¼‰
   - å¿…é¡»åŒ…å«æ¡ˆä»¶å…³é”®äº‹å®å’Œè¯æ®
4. **å­¦ä¹ è®°å½•**ï¼š
   - å±•ç¤ºå­¦ç”Ÿåœ¨è‹æ ¼æ‹‰åº•å¯¹è¯ä¸­çš„å…³é”®æé—®å’Œå›ç­”
   - æ ‡æ³¨å­¦ç”Ÿå·²æŒæ¡çš„çŸ¥è¯†ç‚¹
   - æé†’å­¦ç”Ÿéœ€è¦è¿›ä¸€æ­¥å­¦ä¹ çš„å†…å®¹
5. **å¯è§†åŒ–è¦æ±‚**ï¼š
   - å½“äº‹äººå…³ç³» â†’ å…³ç³»ç½‘ç»œå›¾
   - æ¡ˆä»¶æ—¶é—´çº¿ â†’ æ—¶é—´è½´ï¼ˆæ ‡æ³¨å…³é”®æ—¶é—´èŠ‚ç‚¹ï¼‰
   - è¯æ®è¯„ä¼° â†’ é›·è¾¾å›¾ï¼ˆçœŸå®æ€§/å…³è”æ€§/åˆæ³•æ€§ï¼‰
   - æ³•å¾‹æ¨ç† â†’ æµç¨‹å›¾

**è¾“å‡ºæ ¼å¼**ï¼šçº¯Markdownæ–‡æœ¬ï¼ˆç›´æ¥è¾“å‡ºï¼Œä¸è¦ç”¨markdownä»£ç å—æ ‡è®°ï¼‰

**ç‰¹åˆ«æé†’**ï¼š
- âš ï¸ è¿™æ˜¯**æ¡ˆä¾‹æ•™å­¦è¯¾ä»¶**ï¼Œä¸æ˜¯å¹³å°å±•ç¤ºPPT
- âš ï¸ å¿…é¡»æœ‰æ³•æ¡å¼•ç”¨ï¼Œä¸èƒ½åªè¯´"æ ¹æ®æ³•å¾‹è§„å®š"
- âš ï¸ å¿…é¡»æœ‰æ¡ˆä»¶äº‹å®ï¼Œä¸èƒ½åªè¯´"åŸè¢«å‘Šå‘ç”Ÿçº çº·"
- âš ï¸ å›¾è¡¨é¡µå¿…é¡»ç”¨ \`> ğŸ’¡ è®¾è®¡æç¤ºï¼š...\` æ ¼å¼ï¼ŒåŒ…å«å›¾è¡¨ç±»å‹+å…·ä½“æ•°å€¼
- âš ï¸ æ¯é¡µç”¨ \`---\` åˆ†éš”
- âš ï¸ å¦‚æœæ•°æ®ä¸­æœ‰ç±»ä¼¼æ¡ˆä¾‹æˆ–ç›¸å…³æ³•æ¡ï¼Œå¿…é¡»å¼•ç”¨

ç°åœ¨è¯·ç›´æ¥ç”ŸæˆMarkdownæ ¼å¼çš„æ¡ˆä¾‹æ•™å­¦è¯¾ä»¶å¤§çº²ã€‚`;
  }
}
