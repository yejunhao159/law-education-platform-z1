# æ³•å¾‹æ•™è‚²å¹³å° - æ¶æ„ä¸æ•°æ®æµåˆ†æ

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **æ›´æ–°æ—¥æœŸ**: 2025-01-21
> **å½“å‰åˆ†æ”¯**: feature/teaching-session-storage

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ](#ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ)
2. [å››å¹•æ•™å­¦æµç¨‹](#å››å¹•æ•™å­¦æµç¨‹)
3. [æ•°æ®æµè½¬å›¾](#æ•°æ®æµè½¬å›¾)
4. [APIæ¥å£æ¸…å•](#apiæ¥å£æ¸…å•)
5. [çŠ¶æ€ç®¡ç†ï¼ˆStoreï¼‰](#çŠ¶æ€ç®¡ç†store)
6. [å¿«ç…§å­˜å‚¨æœºåˆ¶](#å¿«ç…§å­˜å‚¨æœºåˆ¶)
7. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
8. [å½“å‰é—®é¢˜åˆ†æ](#å½“å‰é—®é¢˜åˆ†æ)
9. [ä¼˜åŒ–å»ºè®®](#ä¼˜åŒ–å»ºè®®)

---

## ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

### ğŸ—ï¸ æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ³•å¾‹æ•™è‚²å¹³å°                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  å‰ç«¯é¡µé¢å±‚    â”‚    â”‚  APIè·¯ç”±å±‚    â”‚    â”‚  æ•°æ®åº“å±‚   â”‚ â”‚
â”‚  â”‚  (Next.js)    â”‚â—„â”€â”€â”€â”‚  (Route       â”‚â—„â”€â”€â”€â”‚  (Postgres) â”‚ â”‚
â”‚  â”‚               â”‚    â”‚   Handlers)   â”‚    â”‚             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚                    â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           çŠ¶æ€ç®¡ç†å±‚ (Zustand Stores)               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚    â”‚
â”‚  â”‚  â”‚Teaching  â”‚ â”‚  Case    â”‚ â”‚Socratic  â”‚           â”‚    â”‚
â”‚  â”‚  â”‚  Store   â”‚ â”‚  Store   â”‚ â”‚  Store   â”‚           â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚          â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              ä¸šåŠ¡é€»è¾‘å±‚ (Services)                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚  â”‚
â”‚  â”‚  â”‚ Legal Analysis â”‚  â”‚    Socratic    â”‚            â”‚  â”‚
â”‚  â”‚  â”‚   Services     â”‚  â”‚   Dialogue     â”‚            â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚          â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          AIé›†æˆå±‚ (DeepSeek API)                     â”‚  â”‚
â”‚  â”‚         ç»Ÿä¸€è°ƒç”¨ä»£ç† (AiInvocation)                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“¦ æ ¸å¿ƒæŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **å‰ç«¯æ¡†æ¶** | Next.js 15 + React 18 | æœåŠ¡ç«¯æ¸²æŸ“ + å®¢æˆ·ç«¯æ¸²æŸ“æ··åˆ |
| **UIç»„ä»¶** | shadcn/ui + Tailwind CSS | ç°ä»£åŒ–UIç»„ä»¶åº“ |
| **çŠ¶æ€ç®¡ç†** | Zustand + Immer + Persist | è½»é‡çº§çŠ¶æ€ç®¡ç† |
| **ç±»å‹ç³»ç»Ÿ** | TypeScript + Zod | ç¼–è¯‘æ—¶+è¿è¡Œæ—¶ç±»å‹æ ¡éªŒ |
| **æ•°æ®åº“** | PostgreSQL + Prisma | å…³ç³»å‹æ•°æ®åº“ + ORM |
| **AIæœåŠ¡** | DeepSeek API | å¤§è¯­è¨€æ¨¡å‹é›†æˆ |
| **æ ·å¼** | Tailwind CSS + Framer Motion | åŸå­åŒ–CSS + åŠ¨ç”» |

---

## å››å¹•æ•™å­¦æµç¨‹

### ğŸ­ æ•™å­¦å››å¹•æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç¬¬ä¸€å¹•     â”‚â”€â”€â”€â”€â–¶â”‚   ç¬¬äºŒå¹•     â”‚â”€â”€â”€â”€â–¶â”‚   ç¬¬ä¸‰å¹•     â”‚â”€â”€â”€â”€â–¶â”‚   ç¬¬å››å¹•     â”‚
â”‚  æ¡ˆä¾‹å¯¼å…¥    â”‚     â”‚  æ·±åº¦åˆ†æ    â”‚     â”‚ è‹æ ¼æ‹‰åº•å¯¹è¯ â”‚     â”‚  æ€»ç»“æå‡    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  (upload)            (analysis)           (socratic)           (summary)
```

### è¯¦ç»†æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ç¬¬ä¸€å¹•ï¼šæ¡ˆä¾‹å¯¼å…¥ï¼ˆUploadï¼‰                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  ç”¨æˆ·æ“ä½œï¼šä¸Šä¼ åˆ¤å†³ä¹¦æ–‡æ¡£ï¼ˆPDF/TXT/Wordï¼‰                                â”‚
â”‚      â†“                                                                    â”‚
â”‚  å‰ç«¯ç»„ä»¶ï¼šThreeElementsExtractor                                         â”‚
â”‚      â†“                                                                    â”‚
â”‚  APIè°ƒç”¨ï¼šPOST /api/legal-intelligence/extract                           â”‚
â”‚      â†“                                                                    â”‚
â”‚  åç«¯æœåŠ¡ï¼šJudgmentExtractionService                                      â”‚
â”‚      â”œâ”€ è§„åˆ™æå–ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰                                            â”‚
â”‚      â””â”€ AIå¢å¼ºæå–ï¼ˆDeepSeekï¼‰                                            â”‚
â”‚      â†“                                                                    â”‚
â”‚  è¿”å›æ•°æ®ï¼šä¸‰è¦ç´ æå–ç»“æœ                                                 â”‚
â”‚      â”œâ”€ basicInfoï¼ˆåŸºç¡€ä¿¡æ¯ï¼‰                                             â”‚
â”‚      â”œâ”€ threeElements.factsï¼ˆäº‹å®è®¤å®šï¼‰                                   â”‚
â”‚      â”œâ”€ threeElements.evidenceï¼ˆè¯æ®è´¨è¯ï¼‰                                â”‚
â”‚      â””â”€ threeElements.reasoningï¼ˆæ³•å®˜è¯´ç†ï¼‰                               â”‚
â”‚      â†“                                                                    â”‚
â”‚  å­˜å‚¨ä½ç½®ï¼š                                                               â”‚
â”‚      â”œâ”€ useTeachingStore.uploadData.extractedElements                    â”‚
â”‚      â””â”€ useCaseManagementStore.currentCase (as LegalCase)                â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç¬¬äºŒå¹•ï¼šæ·±åº¦åˆ†æï¼ˆAnalysisï¼‰                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  è§¦å‘æ¡ä»¶ï¼šç¬¬ä¸€å¹•å®Œæˆ && æœ‰extractedElements                              â”‚
â”‚      â†“                                                                    â”‚
â”‚  å‰ç«¯ç»„ä»¶ï¼šDeepAnalysis                                                   â”‚
â”‚      â”œâ”€ CaseOverviewï¼ˆæ¡ˆæƒ…æ¦‚è§ˆ + AIæ•…äº‹å™äº‹ï¼‰                             â”‚
â”‚      â”œâ”€ TimelineExplorerï¼ˆæ—¶é—´è½´æ¢ç´¢ï¼‰                                    â”‚
â”‚      â”œâ”€ EvidenceQuizSectionï¼ˆè¯æ®è´¨è¯ï¼‰                                   â”‚
â”‚      â””â”€ DisputeFocusAnalysisï¼ˆäº‰è®®ç„¦ç‚¹åˆ†æï¼‰                              â”‚
â”‚      â†“                                                                    â”‚
â”‚  ğŸ¨ æ•…äº‹æ¨¡å¼ï¼ˆstoryMode = trueï¼‰ï¼š                                        â”‚
â”‚      â”œâ”€ è‡ªåŠ¨è°ƒç”¨ï¼šPOST /api/legal-analysis/intelligent-narrative         â”‚
â”‚      â”‚   â””â”€ CaseNarrativeService.generateIntelligentNarrative()          â”‚
â”‚      â”œâ”€ ç”Ÿæˆï¼šstoryChapters[]ï¼ˆAIå™äº‹ç« èŠ‚ï¼‰                               â”‚
â”‚      â”‚   â”œâ”€ ç¬¬ä¸€ç« ï¼šæ¡ˆæƒ…ç¼˜èµ·                                              â”‚
â”‚      â”‚   â”œâ”€ ç¬¬äºŒç« ï¼šäº‰è®®ç„¦ç‚¹                                              â”‚
â”‚      â”‚   â”œâ”€ ç¬¬ä¸‰ç« ï¼šè¯æ®é“¾æ¡                                              â”‚
â”‚      â”‚   â”œâ”€ ç¬¬å››ç« ï¼šæ³•å¾‹è®ºè¯                                              â”‚
â”‚      â”‚   â””â”€ ç¬¬äº”ç« ï¼šè£åˆ¤ç»“æœ                                              â”‚
â”‚      â””â”€ å­˜å‚¨ï¼šuseTeachingStore.storyChapters                              â”‚
â”‚      â†“                                                                    â”‚
â”‚  ğŸ“Š æ—¶é—´è½´åˆ†æï¼ˆæŒ‰éœ€ï¼‰ï¼š                                                  â”‚
â”‚      â”œâ”€ ç”¨æˆ·ç‚¹å‡»æ—¶é—´è½´äº‹ä»¶                                                â”‚
â”‚      â”œâ”€ APIè°ƒç”¨ï¼šPOST /api/timeline-analysis                             â”‚
â”‚      â”œâ”€ æœåŠ¡ï¼šTimelineAnalysisService                                    â”‚
â”‚      â””â”€ è¿”å›ï¼šè¯¥äº‹ä»¶çš„æ³•å¾‹æ„ä¹‰ã€é£é™©æç¤ºã€ç­–ç•¥å»ºè®®                        â”‚
â”‚      â†“                                                                    â”‚
â”‚  ğŸ” äº‰è®®ç„¦ç‚¹åˆ†æï¼ˆæŒ‰éœ€ï¼‰ï¼š                                                â”‚
â”‚      â”œâ”€ APIè°ƒç”¨ï¼šPOST /api/dispute-analysis                              â”‚
â”‚      â”œâ”€ æœåŠ¡ï¼šDisputeAnalysisService                                     â”‚
â”‚      â””â”€ è¿”å›ï¼šäº‰è®®è¦ç´ ã€è¯æ®æ˜ å°„ã€æ³•å¾‹ä¾æ®                                â”‚
â”‚      â†“                                                                    â”‚
â”‚  å­˜å‚¨ä½ç½®ï¼š                                                               â”‚
â”‚      â”œâ”€ useTeachingStore.analysisData.result                             â”‚
â”‚      â””â”€ useTeachingStore.storyChapters                                   â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ç¬¬ä¸‰å¹•ï¼šè‹æ ¼æ‹‰åº•å¯¹è¯ï¼ˆSocraticï¼‰                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  è§¦å‘æ¡ä»¶ï¼šç¬¬äºŒå¹•å®Œæˆ                                                      â”‚
â”‚      â†“                                                                    â”‚
â”‚  å‰ç«¯ç»„ä»¶ï¼šSocraticDialogue                                               â”‚
â”‚      â”œâ”€ ğŸ§‘â€ğŸ“ å­¦ç”Ÿæ¨¡å¼ï¼šTeacherSocraticï¼ˆæ•™å¸ˆå¼•å¯¼å­¦ç”Ÿï¼‰                     â”‚
â”‚      â””â”€ ğŸ¤– AIæ¨¡å¼ï¼šSocraticChatï¼ˆAIä¸å­¦ç”Ÿå¯¹è¯ï¼‰                           â”‚
â”‚      â†“                                                                    â”‚
â”‚  å¯¹è¯æµç¨‹ï¼š                                                               â”‚
â”‚      1. ç”¨æˆ·å‘é€æ¶ˆæ¯/é€‰æ‹©ä¸»é¢˜                                             â”‚
â”‚      2. APIè°ƒç”¨ï¼šPOST /api/socratic                                      â”‚
â”‚      3. åç«¯æœåŠ¡ï¼šSocraticDialogueService                                â”‚
â”‚      4. AIç”Ÿæˆè‹æ ¼æ‹‰åº•å¼å¼•å¯¼é—®é¢˜                                          â”‚
â”‚      5. è¿”å›ï¼šé—®é¢˜ + æ•™å­¦å¼•å¯¼ + è¿½é—®                                      â”‚
â”‚      â†“                                                                    â”‚
â”‚  æ•°æ®ç»“æ„ï¼š                                                               â”‚
â”‚      â”œâ”€ messages[]ï¼ˆå¯¹è¯å†å²ï¼‰                                            â”‚
â”‚      â”œâ”€ levelï¼ˆ1=beginner, 2=intermediate, 3=advancedï¼‰                  â”‚
â”‚      â”œâ”€ modeï¼ˆexploration/deep-dive/practiceï¼‰                           â”‚
â”‚      â””â”€ completedNodesï¼ˆå·²å®Œæˆçš„çŸ¥è¯†èŠ‚ç‚¹ï¼‰                                â”‚
â”‚      â†“                                                                    â”‚
â”‚  å­˜å‚¨ä½ç½®ï¼š                                                               â”‚
â”‚      â”œâ”€ useTeachingStore.socraticData                                    â”‚
â”‚      â””â”€ useSocraticDialogueStoreï¼ˆä¸“ç”¨Storeï¼‰                            â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç¬¬å››å¹•ï¼šæ€»ç»“æå‡ï¼ˆSummaryï¼‰                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  è§¦å‘æ¡ä»¶ï¼šç¬¬ä¸‰å¹•å®Œæˆ                                                      â”‚
â”‚      â†“                                                                    â”‚
â”‚  å‰ç«¯ç»„ä»¶ï¼šAct6JudgmentSummary                                            â”‚
â”‚      â†“                                                                    â”‚
â”‚  ç”Ÿæˆæ€»ç»“ï¼š                                                               â”‚
â”‚      â”œâ”€ APIè°ƒç”¨ï¼šPOST /api/teaching-acts/summary                         â”‚
â”‚      â”œâ”€ æœåŠ¡ï¼šSummaryGenerationService                                   â”‚
â”‚      â””â”€ è¾“å…¥æ•°æ®ï¼š                                                        â”‚
â”‚          â”œâ”€ extractedElementsï¼ˆç¬¬ä¸€å¹•ï¼‰                                   â”‚
â”‚          â”œâ”€ analysisResultï¼ˆç¬¬äºŒå¹•ï¼‰                                      â”‚
â”‚          â””â”€ socraticDialogueï¼ˆç¬¬ä¸‰å¹•ï¼‰                                    â”‚
â”‚      â†“                                                                    â”‚
â”‚  ç”Ÿæˆå†…å®¹ï¼š                                                               â”‚
â”‚      â”œâ”€ æ¡ˆä¾‹æ ¸å¿ƒè¦ç‚¹                                                      â”‚
â”‚      â”œâ”€ æ³•å¾‹çŸ¥è¯†æ€»ç»“                                                      â”‚
â”‚      â”œâ”€ å­¦ä¹ æ”¶è·ä¸åæ€                                                    â”‚
â”‚      â”œâ”€ ç›¸å…³æ¡ˆä¾‹æ¨è                                                      â”‚
â”‚      â””â”€ å­¦ä¹ å»ºè®®                                                          â”‚
â”‚      â†“                                                                    â”‚
â”‚  å­˜å‚¨ä½ç½®ï¼š                                                               â”‚
â”‚      â””â”€ useTeachingStore.summaryData.caseLearningReport                  â”‚
â”‚      â†“                                                                    â”‚
â”‚  ğŸ“ å®Œæˆå­¦ä¹ æŒ‰é’®ï¼š                                                        â”‚
â”‚      â”œâ”€ è§¦å‘ï¼šä¿å­˜æ•´ä¸ªæ•™å­¦ä¼šè¯åˆ°æ•°æ®åº“                                    â”‚
â”‚      â”œâ”€ APIè°ƒç”¨ï¼šPOST /api/teaching-sessions                             â”‚
â”‚      â”œâ”€ è½¬æ¢ï¼šSnapshotConverter.toDatabase(stores)                       â”‚
â”‚      â””â”€ ä¿å­˜ï¼šPostgreSQL teaching_sessionsè¡¨                             â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ•°æ®æµè½¬å›¾

### ğŸ”„ æ ¸å¿ƒæ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           æ•°æ®ç”Ÿå‘½å‘¨æœŸ                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ æ•°æ®ç”Ÿæˆé˜¶æ®µ
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç”¨æˆ·ä¸Šä¼ æ–‡æ¡£ â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ JudgmentExtractionService   â”‚
   â”‚  - è§„åˆ™æå–                  â”‚
   â”‚  - AIå¢å¼º                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ extractedElements           â”‚
   â”‚ {                           â”‚
   â”‚   basicInfo: {...},         â”‚
   â”‚   threeElements: {          â”‚
   â”‚     facts: {...},           â”‚
   â”‚     evidence: {...},        â”‚
   â”‚     reasoning: {...}        â”‚
   â”‚   }                         â”‚
   â”‚ }                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Storeå­˜å‚¨ï¼ˆå†…å­˜ï¼‰            â”‚
   â”‚  - useTeachingStore         â”‚
   â”‚  - useCaseManagementStore   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   [ç”¨æˆ·å­¦ä¹ è¿‡ç¨‹]
          â†“

2ï¸âƒ£ æ•°æ®å¢å¼ºé˜¶æ®µï¼ˆç¬¬äºŒå¹•ï¼‰
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ AIç”Ÿæˆæ•…äº‹ç« èŠ‚               â”‚
   â”‚ CaseNarrativeService        â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ storyChapters[]             â”‚
   â”‚ [                           â”‚
   â”‚   {                         â”‚
   â”‚     id: 'chapter-1',        â”‚
   â”‚     title: 'æ¡ˆæƒ…ç¼˜èµ·',      â”‚
   â”‚     content: '...',         â”‚
   â”‚     icon: 'ğŸ“‹'              â”‚
   â”‚   },                        â”‚
   â”‚   ...                       â”‚
   â”‚ ]                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Storeå­˜å‚¨                    â”‚
   â”‚ useTeachingStore.           â”‚
   â”‚   storyChapters             â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“

3ï¸âƒ£ æ•°æ®æŒä¹…åŒ–é˜¶æ®µï¼ˆå®Œæˆå­¦ä¹ ï¼‰
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç”¨æˆ·ç‚¹å‡»"å®Œæˆå­¦ä¹ "           â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SnapshotConverter.          â”‚
   â”‚   toDatabase(stores)        â”‚
   â”‚                             â”‚
   â”‚ è½¬æ¢æ‰€æœ‰Storeæ•°æ®ä¸ºï¼š        â”‚
   â”‚  - act1_upload (JSONB)      â”‚
   â”‚  - act2_analysis (JSONB)    â”‚
   â”‚  - act3_socratic (JSONB)    â”‚
   â”‚  - act4_summary (JSONB)     â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ PostgreSQL                  â”‚
   â”‚ teaching_sessionsè¡¨         â”‚
   â”‚                             â”‚
   â”‚ INSERT INTO                 â”‚
   â”‚   teaching_sessions(...)    â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   [æ•°æ®å·²ä¿å­˜åˆ°æ•°æ®åº“]

4ï¸âƒ£ æ•°æ®æ¢å¤é˜¶æ®µï¼ˆæŸ¥çœ‹å†å²è®°å½•ï¼‰
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç”¨æˆ·è®¿é—®ï¼š                   â”‚
   â”‚ /dashboard/my-courseware/   â”‚
   â”‚   [id]                      â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ APIè°ƒç”¨ï¼š                    â”‚
   â”‚ GET /api/teaching-sessions/ â”‚
   â”‚   [id]                      â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ä»PostgreSQLè¯»å–å¿«ç…§         â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SnapshotConverter.          â”‚
   â”‚   toStore(snapshot)         â”‚
   â”‚                             â”‚
   â”‚ è¿˜åŸæ•°æ®ä¸ºStoreæ ¼å¼          â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ æ¢å¤åˆ°Zustand Store         â”‚
   â”‚  - setExtractedElements()   â”‚
   â”‚  - setAnalysisResult()      â”‚
   â”‚  - setStoryChapters() âœ…    â”‚
   â”‚  - setCaseLearningReport()  â”‚
   â”‚  - setCurrentCase()         â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ è·³è½¬åˆ°å››å¹•ç•Œé¢               â”‚
   â”‚ router.push('/dashboard/    â”‚
   â”‚   judgment')                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ—„ï¸ Storeæ•°æ®ç»“æ„

```typescript
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    useTeachingStore                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  uploadData: {                                             â”‚
â”‚    extractedElements: Record<string, unknown> | null       â”‚
â”‚    confidence: number                                      â”‚
â”‚  }                                                         â”‚
â”‚                                                            â”‚
â”‚  analysisData: {                                           â”‚
â”‚    result: DeepAnalysisResult | null                      â”‚
â”‚    isAnalyzing: boolean                                    â”‚
â”‚  }                                                         â”‚
â”‚                                                            â”‚
â”‚  storyChapters: StoryChapter[]  // âœ… ç¬¬äºŒå¹•AIå™äº‹        â”‚
â”‚                                                            â”‚
â”‚  socraticData: {                                           â”‚
â”‚    isActive: boolean                                       â”‚
â”‚    level: 1 | 2 | 3                                        â”‚
â”‚    completedNodes: Set<string>                             â”‚
â”‚  }                                                         â”‚
â”‚                                                            â”‚
â”‚  summaryData: {                                            â”‚
â”‚    caseLearningReport: CaseLearningReport | null           â”‚
â”‚    isGenerating: boolean                                   â”‚
â”‚  }                                                         â”‚
â”‚                                                            â”‚
â”‚  currentAct: 'upload' | 'analysis' | 'socratic' |          â”‚
â”‚              'summary'                                     â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               useCaseManagementStore                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  currentCase: LegalCase | null                             â”‚
â”‚    {                                                       â”‚
â”‚      id: string                                            â”‚
â”‚      basicInfo: BasicInfo                                  â”‚
â”‚      threeElements: ThreeElements                          â”‚
â”‚      timeline: TimelineEvent[]                             â”‚
â”‚      metadata: CaseMetadata                                â”‚
â”‚    }                                                       â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            useSocraticDialogueStore                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  messages: Message[]                                       â”‚
â”‚  currentLevel: DialogueLevel                               â”‚
â”‚  currentMode: DialogueMode                                 â”‚
â”‚  isLoading: boolean                                        â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## APIæ¥å£æ¸…å•

### ğŸ“¡ å®Œæ•´APIåˆ—è¡¨

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ | æœåŠ¡ |
|------|------|------|------|
| **è®¤è¯ç›¸å…³** | | | |
| `/api/auth/login` | POST | ç”¨æˆ·ç™»å½• | - |
| `/api/auth/logout` | POST | ç”¨æˆ·ç™»å‡º | - |
| `/api/auth/session` | GET | è·å–ä¼šè¯ | - |
| **æ¡ˆä¾‹æå–** | | | |
| `/api/legal-intelligence/extract` | POST | æå–åˆ¤å†³ä¹¦ä¸‰è¦ç´  | JudgmentExtractionService |
| **æ·±åº¦åˆ†æ** | | | |
| `/api/legal-analysis` | POST | ç»¼åˆæ³•å¾‹åˆ†æ | LegalAnalysisFacade |
| `/api/legal-analysis/intelligent-narrative` | POST | AIæ™ºèƒ½å™äº‹ç”Ÿæˆ | CaseNarrativeService |
| `/api/legal-analysis/stream` | POST | æµå¼åˆ†æï¼ˆSSEï¼‰ | - |
| `/api/legal-analysis/event-claim` | POST | äº‹ä»¶è¯·æ±‚æƒåˆ†æ | - |
| **æ—¶é—´è½´åˆ†æ** | | | |
| `/api/timeline-analysis` | POST | æ—¶é—´è½´äº‹ä»¶åˆ†æ | TimelineAnalysisService |
| **äº‰è®®åˆ†æ** | | | |
| `/api/dispute-analysis` | POST | äº‰è®®ç„¦ç‚¹åˆ†æ | DisputeAnalysisService |
| **è¯æ®è´¨é‡** | | | |
| `/api/evidence-quality` | POST | è¯æ®è´¨é‡è¯„ä¼° | EvidenceIntelligenceService |
| **è‹æ ¼æ‹‰åº•å¯¹è¯** | | | |
| `/api/socratic` | POST | è‹æ ¼æ‹‰åº•å¯¹è¯ | SocraticDialogueService |
| `/api/socratic/stream-test` | POST | æµå¼å¯¹è¯æµ‹è¯• | - |
| `/api/socratic/view-prompt` | POST | æŸ¥çœ‹æç¤ºè¯ | - |
| **æ•™å­¦ä¼šè¯** | | | |
| `/api/teaching-sessions` | GET | è·å–ä¼šè¯åˆ—è¡¨ | - |
| `/api/teaching-sessions` | POST | ä¿å­˜æ•™å­¦ä¼šè¯ | SnapshotConverter |
| `/api/teaching-sessions/[id]` | GET | è·å–ä¼šè¯è¯¦æƒ… | SnapshotConverter |
| **æ€»ç»“ç”Ÿæˆ** | | | |
| `/api/teaching-acts/summary` | POST | ç”Ÿæˆå­¦ä¹ æ€»ç»“ | SummaryGenerationService |
| **PPTç”Ÿæˆ** | | | |
| `/api/ppt` | POST | ç”Ÿæˆè¯¾ä»¶PPT | PptGeneratorService |
| **è¯¾å ‚ç®¡ç†** | | | |
| `/api/classroom/[code]/check` | POST | æ£€æŸ¥è¯¾å ‚ä»£ç  | - |
| `/api/classroom/[code]/question` | POST | è¯¾å ‚æé—® | - |
| **å¥åº·æ£€æŸ¥** | | | |
| `/api/health` | GET | ç³»ç»Ÿå¥åº·æ£€æŸ¥ | - |
| `/api/health/socratic` | GET | SocraticæœåŠ¡æ£€æŸ¥ | - |

### ğŸ”‘ å…³é”®APIè¯¦è§£

#### 1. æ¡ˆä¾‹æå– API

```http
POST /api/legal-intelligence/extract

Request Body:
{
  "documentText": "åˆ¤å†³ä¹¦å…¨æ–‡...",
  "extractionMethod": "hybrid" | "pure-ai" | "rule-enhanced"
}

Response:
{
  "success": true,
  "data": {
    "basicInfo": {
      "caseNumber": "ï¼ˆ2023ï¼‰äº¬0105æ°‘åˆ12345å·",
      "court": "åŒ—äº¬å¸‚æœé˜³åŒºäººæ°‘æ³•é™¢",
      "judgeDate": "2023-05-15",
      "parties": {
        "plaintiff": [{ name: "å¼ ä¸‰" }],
        "defendant": [{ name: "æå››" }]
      }
    },
    "threeElements": {
      "facts": { ... },
      "evidence": { ... },
      "reasoning": { ... }
    },
    "confidence": 85,
    "processingTime": 2340
  }
}
```

#### 2. AIæ™ºèƒ½å™äº‹ API

```http
POST /api/legal-analysis/intelligent-narrative

Request Body:
{
  "caseData": {
    "basicInfo": { ... },
    "threeElements": { ... }
  },
  "depth": "basic" | "detailed" | "comprehensive",
  "narrativeStyle": "story"
}

Response:
{
  "success": true,
  "chapters": [
    {
      "id": "chapter-1",
      "title": "æ¡ˆæƒ…ç¼˜èµ·",
      "content": "2023å¹´åˆï¼ŒåŸå‘Šå¼ ä¸‰ä¸è¢«å‘Šæå››å› ...",
      "icon": "ğŸ“‹",
      "color": "blue",
      "timelineEvents": ["event-1", "event-2"],
      "legalSignificance": "è¯¥æ¡ˆæ¶‰åŠ..."
    },
    // ... æ›´å¤šç« èŠ‚
  ],
  "metadata": {
    "generatedAt": "2023-05-15T10:30:00Z",
    "processingTime": 3500,
    "confidence": 90,
    "model": "deepseek-chat-narrative"
  }
}
```

#### 3. æ•™å­¦ä¼šè¯ä¿å­˜ API

```http
POST /api/teaching-sessions

Request Body:
{
  "caseTitle": "å¼ ä¸‰è¯‰æå››ä¹°å–åˆåŒçº çº·æ¡ˆ",
  "caseNumber": "ï¼ˆ2023ï¼‰äº¬0105æ°‘åˆ12345å·",
  "snapshot": {
    "uploadData": { ... },
    "analysisData": { ... },
    "storyChapters": [ ... ],  // âœ… åŒ…å«AIå™äº‹
    "socraticData": { ... },
    "summaryData": { ... }
  }
}

Response:
{
  "success": true,
  "data": {
    "id": "uuid-xxx-xxx",
    "caseTitle": "å¼ ä¸‰è¯‰æå››ä¹°å–åˆåŒçº çº·æ¡ˆ",
    "createdAt": "2023-05-15T10:30:00Z"
  }
}
```

#### 4. æ•™å­¦ä¼šè¯æ¢å¤ API

```http
GET /api/teaching-sessions/[id]

Response:
{
  "success": true,
  "data": {
    "id": "uuid-xxx-xxx",
    "caseTitle": "å¼ ä¸‰è¯‰æå››ä¹°å–åˆåŒçº çº·æ¡ˆ",
    "caseNumber": "ï¼ˆ2023ï¼‰äº¬0105æ°‘åˆ12345å·",
    "act1_upload": {
      "extractedElements": { ... },
      "confidence": 85
    },
    "act2_analysis": {
      "result": { ... },
      "storyChapters": [ ... ]  // âœ… AIå™äº‹ç« èŠ‚
    },
    "act3_socratic": { ... },
    "act4_summary": {
      "caseLearningReport": { ... }
    },
    "createdAt": "2023-05-15T10:30:00Z",
    "updatedAt": "2023-05-15T12:45:00Z"
  }
}
```

---

## çŠ¶æ€ç®¡ç†ï¼ˆStoreï¼‰

### ğŸª Storeæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Zustand Storeç”Ÿæ€                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ useTeachingStore   â”‚  â—€â”€â”€â”€ æ ¸å¿ƒStore                â”‚
â”‚  â”‚                    â”‚                                 â”‚
â”‚  â”‚ â€¢ å››å¹•çŠ¶æ€ç®¡ç†      â”‚                                 â”‚
â”‚  â”‚ â€¢ æ•™å­¦è¿›åº¦è¿½è¸ª      â”‚                                 â”‚
â”‚  â”‚ â€¢ æ•°æ®ç¼“å­˜         â”‚                                 â”‚
â”‚  â”‚ â€¢ å¿«ç…§åºåˆ—åŒ–       â”‚                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚            â”‚                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  Zustand Middleware                â”‚                â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚
â”‚  â”‚  â”‚  immer   â”‚  â”‚   persist    â”‚  â”‚                â”‚
â”‚  â”‚  â”‚ï¼ˆä¸å¯å˜ï¼‰ â”‚  â”‚ï¼ˆLocalStorageï¼‰â”‚  â”‚                â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ useCaseManagement  â”‚  â—€â”€â”€â”€ æ¡ˆä¾‹ç®¡ç†                 â”‚
â”‚  â”‚    Store           â”‚                                â”‚
â”‚  â”‚                    â”‚                                 â”‚
â”‚  â”‚ â€¢ å½“å‰æ¡ˆä¾‹         â”‚                                 â”‚
â”‚  â”‚ â€¢ æ¡ˆä¾‹åˆ—è¡¨         â”‚                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ useSocraticDialogueâ”‚  â—€â”€â”€â”€ å¯¹è¯ç®¡ç†                 â”‚
â”‚  â”‚    Store           â”‚                                â”‚
â”‚  â”‚                    â”‚                                 â”‚
â”‚  â”‚ â€¢ å¯¹è¯å†å²         â”‚                                 â”‚
â”‚  â”‚ â€¢ æ•™å­¦å±‚çº§         â”‚                                 â”‚
â”‚  â”‚ â€¢ çŸ¥è¯†èŠ‚ç‚¹         â”‚                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æŒä¹…åŒ–ç­–ç•¥

| Store | æŒä¹…åŒ– | å­˜å‚¨ä½ç½® | è¯´æ˜ |
|-------|--------|---------|------|
| useTeachingStore | âœ… æ˜¯ | localStorage | ä¼šè¯æœŸé—´ä¿æŒï¼Œåˆ·æ–°ä¸ä¸¢å¤± |
| useCaseManagementStore | âœ… æ˜¯ | localStorage | ä¿å­˜å½“å‰æ¡ˆä¾‹ |
| useSocraticDialogueStore | âš ï¸ éƒ¨åˆ† | - | ä»…å†…å­˜ï¼Œé¡µé¢åˆ·æ–°ä¼šä¸¢å¤± |

---

## å¿«ç…§å­˜å‚¨æœºåˆ¶

### ğŸ“¸ å¿«ç…§ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¿«ç…§è½¬æ¢å™¨                              â”‚
â”‚                  (SnapshotConverter)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼š                                              â”‚
â”‚                                                             â”‚
â”‚  1ï¸âƒ£ toDatabase(stores) â†’ DatabaseSnapshot                 â”‚
â”‚     åŠŸèƒ½ï¼šå°†Zustand Storeåºåˆ—åŒ–ä¸ºæ•°æ®åº“æ ¼å¼                 â”‚
â”‚                                                             â”‚
â”‚     è¾“å…¥ï¼š                                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚     â”‚ useTeachingStore.getState() â”‚                        â”‚
â”‚     â”‚ useCaseManagementStore.     â”‚                        â”‚
â”‚     â”‚   getState()                â”‚                        â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚              â†“                                              â”‚
â”‚     å¤„ç†ï¼š                                                  â”‚
â”‚     â€¢ æå–extractedElements â†’ act1_upload                  â”‚
â”‚     â€¢ æå–analysisResult + storyChapters â†’ act2_analysis   â”‚
â”‚     â€¢ æå–socraticData â†’ act3_socratic                     â”‚
â”‚     â€¢ æå–caseLearningReport â†’ act4_summary                â”‚
â”‚              â†“                                              â”‚
â”‚     è¾“å‡ºï¼š                                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚     â”‚ {                           â”‚                        â”‚
â”‚     â”‚   act1_upload: JSONB,       â”‚                        â”‚
â”‚     â”‚   act2_analysis: JSONB,     â”‚                        â”‚
â”‚     â”‚   act3_socratic: JSONB,     â”‚                        â”‚
â”‚     â”‚   act4_summary: JSONB       â”‚                        â”‚
â”‚     â”‚ }                           â”‚                        â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                             â”‚
â”‚  2ï¸âƒ£ toStore(snapshot) â†’ StoreData                         â”‚
â”‚     åŠŸèƒ½ï¼šå°†æ•°æ®åº“å¿«ç…§ååºåˆ—åŒ–ä¸ºStoreæ ¼å¼                   â”‚
â”‚                                                             â”‚
â”‚     è¾“å…¥ï¼š                                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚     â”‚ {                           â”‚                        â”‚
â”‚     â”‚   act1_upload: {...},       â”‚                        â”‚
â”‚     â”‚   act2_analysis: {...},     â”‚                        â”‚
â”‚     â”‚   act3_socratic: {...},     â”‚                        â”‚
â”‚     â”‚   act4_summary: {...}       â”‚                        â”‚
â”‚     â”‚ }                           â”‚                        â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚              â†“                                              â”‚
â”‚     å¤„ç†ï¼š                                                  â”‚
â”‚     â€¢ è¿˜åŸextractedElements                                â”‚
â”‚     â€¢ è¿˜åŸanalysisResult                                   â”‚
â”‚     â€¢ è¿˜åŸstoryChapters âœ…                                 â”‚
â”‚     â€¢ è¿˜åŸcaseLearningReport                               â”‚
â”‚              â†“                                              â”‚
â”‚     è¾“å‡ºï¼š                                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚     â”‚ {                           â”‚                        â”‚
â”‚     â”‚   uploadData: {...},        â”‚                        â”‚
â”‚     â”‚   analysisData: {...},      â”‚                        â”‚
â”‚     â”‚   storyChapters: [...],     â”‚                        â”‚
â”‚     â”‚   summaryData: {...}        â”‚                        â”‚
â”‚     â”‚ }                           â”‚                        â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ å¿«ç…§ä¿å­˜ä¸æ¢å¤æµç¨‹

**ä¿å­˜æµç¨‹**:
```
ç”¨æˆ·ç‚¹å‡»"å®Œæˆå­¦ä¹ "
    â†“
è°ƒç”¨ SnapshotConverter.toDatabase()
    â†“
å°†StoreçŠ¶æ€è½¬æ¢ä¸ºJSONBæ ¼å¼
    â†“
POST /api/teaching-sessions
    â†“
å­˜å…¥PostgreSQL teaching_sessionsè¡¨
```

**æ¢å¤æµç¨‹**:
```
ç”¨æˆ·è®¿é—® /dashboard/my-courseware/[id]
    â†“
GET /api/teaching-sessions/[id]
    â†“
è°ƒç”¨ SnapshotConverter.toStore()
    â†“
æ¢å¤å„ä¸ªStoreçŠ¶æ€ï¼š
  - setExtractedElements()
  - setAnalysisResult()
  - setStoryChapters() âœ…
  - setCaseLearningReport()
  - setCurrentCase()
    â†“
è·³è½¬åˆ° /dashboard/judgmentï¼ˆå››å¹•ç•Œé¢ï¼‰
```

---

## æ•°æ®åº“è®¾è®¡

### ğŸ—„ï¸ PostgreSQL Schema

#### teaching_sessionsè¡¨

```sql
CREATE TABLE teaching_sessions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),

  -- å…ƒæ•°æ®
  case_title VARCHAR(500) NOT NULL,
  case_number VARCHAR(100),
  user_id UUID REFERENCES users(id),

  -- å››å¹•å¿«ç…§ï¼ˆJSONBï¼‰
  act1_upload JSONB,      -- ç¬¬ä¸€å¹•ï¼šæ¡ˆä¾‹å¯¼å…¥æ•°æ®
  act2_analysis JSONB,    -- ç¬¬äºŒå¹•ï¼šåˆ†æç»“æœ + storyChapters
  act3_socratic JSONB,    -- ç¬¬ä¸‰å¹•ï¼šå¯¹è¯å†å²
  act4_summary JSONB,     -- ç¬¬å››å¹•ï¼šå­¦ä¹ æ€»ç»“

  -- æ—¶é—´æˆ³
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),

  -- ç´¢å¼•
  INDEX idx_user_id (user_id),
  INDEX idx_created_at (created_at DESC)
);
```

#### act2_analysis æ•°æ®ç»“æ„

```json
{
  "result": {
    "timeline": [...],
    "disputePoints": [...],
    "evidenceMapping": [...],
    "narrative": {
      "chapters": [  // âœ… AIæ•…äº‹ç« èŠ‚
        {
          "id": "chapter-1",
          "title": "æ¡ˆæƒ…ç¼˜èµ·",
          "content": "...",
          "icon": "ğŸ“‹",
          "color": "blue"
        },
        ...
      ]
    }
  },
  "storyChapters": [...]  // âš ï¸ å†—ä½™å­˜å‚¨ï¼ˆå¾…ä¼˜åŒ–ï¼‰
}
```

---

## å½“å‰é—®é¢˜åˆ†æ

### âŒ å·²å‘ç°çš„é—®é¢˜

#### 1. **å¿«ç…§æ¢å¤ä¸å®Œæ•´** âœ… å·²ä¿®å¤

**é—®é¢˜æè¿°**:
- ç”¨æˆ·åé¦ˆï¼š"ç¬¬äºŒå¹•ä¾æ—§åœ¨è°ƒç”¨AIåˆ†æ"
- æ ¹æœ¬åŸå› ï¼šstoryChaptersæœªè¢«æ¢å¤åˆ°Store

**ä¿®å¤æ–¹æ¡ˆ**:
```typescript
// app/dashboard/my-courseware/[id]/page.tsx (lines 155-161)
if (storeData.storyChapters && storeData.storyChapters.length > 0) {
  useTeachingStore.getState().setStoryChapters(storeData.storyChapters)
  console.log('âœ… [SessionDetail] storyChapterså·²æ¢å¤')
}
```

**çŠ¶æ€**: âœ… å·²åœ¨æœ€æ–°commitä¸­ä¿®å¤

---

#### 2. **ç±»å‹ç³»ç»Ÿæ··ä¹±** âš ï¸ éƒ¨åˆ†ä¿®å¤

**é—®é¢˜æè¿°**:
- å­˜åœ¨ä¸¤ä¸ªç‰ˆæœ¬çš„LegalCaseå®šä¹‰
- æ—§ç‰ˆæœ¬ï¼ˆtypes/legal-case.tsï¼‰åŒ…å«threeElements
- æ–°ç‰ˆæœ¬ï¼ˆsrc/types/domains/case-management.tsï¼‰ä¸åŒ…å«

**å½±å“**:
- å¯¼è‡´ç±»å‹é”™è¯¯
- ä»£ç å¯ç»´æŠ¤æ€§é™ä½

**ä¿®å¤æ–¹æ¡ˆ**:
```typescript
// src/types/index.ts
// æ˜ç¡®å¯¼å‡ºæ—§ç‰ˆæœ¬LegalCaseï¼Œä¿æŒå‘åå…¼å®¹
export type {
  LegalCase,
  ThreeElements,
  // ...
} from '../../types/legal-case';
```

**çŠ¶æ€**: âš ï¸ ä¸´æ—¶æ–¹æ¡ˆï¼Œå»ºè®®é•¿æœŸç»Ÿä¸€ç±»å‹å®šä¹‰

---

#### 3. **æ•°æ®å†—ä½™å­˜å‚¨** âš ï¸ å¾…ä¼˜åŒ–

**é—®é¢˜æè¿°**:
```json
// act2_analysisä¸­åŒæ—¶å­˜åœ¨ï¼š
{
  "result": {
    "narrative": {
      "chapters": [...]  // ä½ç½®1
    }
  },
  "storyChapters": [...]   // ä½ç½®2ï¼ˆå†—ä½™ï¼‰
}
```

**å»ºè®®**:
- ç»Ÿä¸€å­˜å‚¨ä½ç½®
- å‡å°‘æ•°æ®å†—ä½™

---

#### 4. **LegalAnalysisFacadeç±»å‹é”™è¯¯** âŒ æœªä¿®å¤

**é—®é¢˜**:
- 9ä¸ªç±»å‹ä¸åŒ¹é…é”™è¯¯
- æ¶‰åŠå¤šä¸ªæ¥å£å®šä¹‰å†²çª

**çŠ¶æ€**: âŒ éœ€è¦æ·±å…¥é‡æ„

---

#### 5. **æœªä½¿ç”¨å¯¼å‡ºè¿‡å¤š** âš ï¸ æŒç»­æ¸…ç†ä¸­

**å½“å‰è¿›åº¦**:
- âœ… src/types/index.ts (æ¸…ç†30+ä¸ª)
- âœ… lib/types/socratic/index.ts (æ¸…ç†48ä¸ª)
- â­ï¸ src/domains/stores.ts (44ä¸ªå¾…æ¸…ç†)
- â­ï¸ types/legal-case.ts (40ä¸ªå¾…æ¸…ç†)

---

## ä¼˜åŒ–å»ºè®®

### ğŸ¯ çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰

#### 1. ç»Ÿä¸€LegalCaseç±»å‹å®šä¹‰

**ç›®æ ‡**: æ¶ˆé™¤ç±»å‹å†²çª

**æ–¹æ¡ˆ**:
```typescript
// å»ºè®®ç»Ÿä¸€ä½¿ç”¨æ–°ç‰ˆæœ¬å®šä¹‰
// src/types/domains/case-management.ts
export const LegalCaseSchema = z.object({
  id: z.string(),
  createdAt: z.string(),
  updatedAt: z.string(),
  basicInfo: BasicInfoSchema,
  threeElements: ThreeElementsSchema,  // æ·»åŠ æ­¤å­—æ®µ
  timeline: z.array(TimelineEventSchema),
  metadata: CaseMetadataSchema
});
```

**å½±å“**: éœ€è¦å…¨å±€æœç´¢æ›¿æ¢imports

---

#### 2. ä¼˜åŒ–å¿«ç…§æ•°æ®ç»“æ„

**å½“å‰é—®é¢˜**: storyChapterså­˜å‚¨åœ¨ä¸¤ä¸ªä½ç½®

**å»ºè®®æ–¹æ¡ˆ**:
```typescript
// SnapshotConverter.toDatabase()
{
  act2_analysis: {
    result: analysisResult,
    // ç§»é™¤å†—ä½™çš„storyChaptersï¼Œç»Ÿä¸€ä»narrative.chaptersè¯»å–
  }
}

// SnapshotConverter.toStore()
const storyChapters =
  snapshot.act2_analysis?.result?.narrative?.chapters || [];
```

---

#### 3. æ·»åŠ æ•°æ®éªŒè¯

**å»ºè®®**:
```typescript
// ä½¿ç”¨Zod schemaéªŒè¯å¿«ç…§æ•°æ®
const SnapshotSchema = z.object({
  act1_upload: z.object({
    extractedElements: z.record(z.unknown()),
    confidence: z.number()
  }).optional(),
  act2_analysis: z.object({
    result: DeepAnalysisResultSchema,
  }).optional(),
  // ...
});

// åœ¨æ¢å¤æ—¶éªŒè¯
export function toStore(snapshot: DatabaseSnapshot): StoreData {
  const validated = SnapshotSchema.parse(snapshot);
  // ...
}
```

---

### ğŸš€ ä¸­æœŸä¼˜åŒ–ï¼ˆ1-2ä¸ªæœˆï¼‰

#### 1. å®ç°å¢é‡ä¿å­˜

**å½“å‰**: åªæœ‰"å®Œæˆå­¦ä¹ "æ‰ä¿å­˜

**å»ºè®®**: æ¯å¹•å®Œæˆåè‡ªåŠ¨ä¿å­˜
```typescript
// useTeachingStore
markActComplete: (act: ActType) => {
  set(state => {
    state.progress.completedActs.add(act);
  });

  // è‡ªåŠ¨ä¿å­˜å¿«ç…§
  saveSessionSnapshot();
}
```

---

#### 2. æ·»åŠ ç‰ˆæœ¬æ§åˆ¶

**å»ºè®®**: å¿«ç…§å¢åŠ ç‰ˆæœ¬å·
```sql
ALTER TABLE teaching_sessions
  ADD COLUMN snapshot_version VARCHAR(10) DEFAULT 'v1.0';
```

**å¥½å¤„**:
- æ”¯æŒæ•°æ®è¿ç§»
- å‘åå…¼å®¹
- ä¾¿äºå‡çº§

---

#### 3. æ€§èƒ½ä¼˜åŒ–

**é—®é¢˜**: å¤§å‹æ¡ˆä¾‹JSONä½“ç§¯å¤§

**å»ºè®®**:
- å‹ç¼©JSONB
- åˆ†ç¦»å¤§å‹å­—æ®µåˆ°ä¸“ç”¨è¡¨
- æ·»åŠ ç¼“å­˜å±‚ï¼ˆRedisï¼‰

---

### ğŸŒŸ é•¿æœŸä¼˜åŒ–ï¼ˆ3-6ä¸ªæœˆï¼‰

#### 1. å¾®æœåŠ¡æ¶æ„

**å»ºè®®æ‹†åˆ†**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Web App   â”‚  â”‚ AI Service  â”‚  â”‚   Storage   â”‚
â”‚  (Next.js)  â”‚â—„â”€â”‚ (DeepSeek)  â”‚â—„â”€â”‚ (Postgres)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†‘                  â†‘
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         GraphQL/gRPC
```

---

#### 2. å®æ—¶åä½œåŠŸèƒ½

**å»ºè®®**: ä½¿ç”¨WebSocketæ”¯æŒï¼š
- å¤šç”¨æˆ·åŒæ—¶å­¦ä¹ åŒä¸€æ¡ˆä¾‹
- å®æ—¶å…±äº«ç¬”è®°
- è¯¾å ‚äº’åŠ¨

---

#### 3. AIèƒ½åŠ›å¢å¼º

**å»ºè®®**:
- å¤šæ¨¡å‹æ”¯æŒï¼ˆGPT-4, Claudeç­‰ï¼‰
- æœ¬åœ°æ¨¡å‹éƒ¨ç½²
- ä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„

---

## æ€»ç»“

### âœ… ç³»ç»Ÿä¼˜åŠ¿

1. **æ¸…æ™°çš„å››å¹•æ•™å­¦æµç¨‹**
2. **å®Œå–„çš„æ•°æ®æµè½¬æœºåˆ¶**
3. **çµæ´»çš„çŠ¶æ€ç®¡ç†**
4. **AIæ·±åº¦é›†æˆ**

### âš ï¸ éœ€è¦æ”¹è¿›

1. **ç±»å‹ç³»ç»Ÿç»Ÿä¸€**
2. **æ•°æ®ç»“æ„ä¼˜åŒ–**
3. **æ€§èƒ½æå‡**
4. **æµ‹è¯•è¦†ç›–**

### ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. âœ… å®ŒæˆstoryChaptersæ¢å¤ï¼ˆå·²å®Œæˆï¼‰
2. â­ï¸ æµ‹è¯•å¿«ç…§åŠŸèƒ½
3. â­ï¸ ç»Ÿä¸€ç±»å‹å®šä¹‰
4. â­ï¸ ä¼˜åŒ–æ•°æ®å­˜å‚¨

---

**æ–‡æ¡£ç»´æŠ¤**: è¯·åœ¨æ¶æ„å˜æ›´æ—¶åŠæ—¶æ›´æ–°æ­¤æ–‡æ¡£
